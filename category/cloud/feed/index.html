<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>Cloud &#8211; IT Nerd Space</title>
	<atom:link href="http://itnerd.space/category/cloud/feed/" rel="self" type="application/rss+xml" />
	<link>http://itnerd.space</link>
	<description>Blog about Cloud, Automation, Android, Smart things...</description>
	<lastBuildDate>Tue, 11 Jul 2017 19:44:22 +0000</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>hourly</sy:updatePeriod>
	<sy:updateFrequency>1</sy:updateFrequency>
	<generator>https://wordpress.org/?v=4.8</generator>

<image>
	<url>https://i2.wp.com/itnerd.space/wp-content/uploads/2016/10/cropped-99789e30b0a6eac11f33246750ca29f9.jpg?fit=32%2C32</url>
	<title>Cloud &#8211; IT Nerd Space</title>
	<link>http://itnerd.space</link>
	<width>32</width>
	<height>32</height>
</image> 
<site xmlns="com-wordpress:feed-additions:1">119014820</site>	<item>
		<title>Control your TP-Link HS100 smart plug with IFTTT</title>
		<link>http://itnerd.space/2017/01/22/control-your-tp-link-hs100-smart-plug-with-ifttt/</link>
		<comments>http://itnerd.space/2017/01/22/control-your-tp-link-hs100-smart-plug-with-ifttt/#comments</comments>
		<pubDate>Sun, 22 Jan 2017 16:32:43 +0000</pubDate>
		<dc:creator><![CDATA[Alex D.]]></dc:creator>
				<category><![CDATA[Automation]]></category>
		<category><![CDATA[Cloud]]></category>
		<category><![CDATA[How-to]]></category>
		<category><![CDATA[HS100]]></category>
		<category><![CDATA[IoT]]></category>
		<category><![CDATA[Smart Things]]></category>

		<guid isPermaLink="false">http://itnerd.space/?p=208</guid>
		<description><![CDATA[In my previous post we saw how we can control a TP-Link HS100 smart plug from command line from anywhere on Internet, without having to rely on the Kasa app, which unleashes a new world of possibilities. In this post we'll see how to switch the plug On/Off directly from IFTTT, without any third-party component, nor without any other device at home other than the smart plug itself.]]></description>
				<content:encoded><![CDATA[<p>In my previous post we saw how we can <a href="http://itnerd.space/2017/01/22/how-to-control-your-tp-link-hs100-smartplug-from-internet/">control a TP-Link HS100 smart plug from command line from anywhere on Internet</a>, without the Kasa app. In this post we&#8217;ll see how to switch the plug On/Off directly from IFTTT, without any third-party component, nor without any other device at home other than the smart plug itself.</p>
<p>In IFTTT we&#8217;ll use the Maker service, which let&#8217;s us call a custom HTTP GET/POST request with some Json payload, so that&#8217;s exactly what we need here.</p>
<p><img data-attachment-id="209" data-permalink="http://itnerd.space/2017/01/22/control-your-tp-link-hs100-smart-plug-with-ifttt/makeractionserviceifttt/" data-orig-file="https://i2.wp.com/itnerd.space/wp-content/uploads/2017/01/MakerActionServiceIFTTT.png?fit=310%2C310" data-orig-size="310,310" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="MakerActionServiceIFTTT" data-image-description="" data-medium-file="https://i2.wp.com/itnerd.space/wp-content/uploads/2017/01/MakerActionServiceIFTTT.png?fit=300%2C300" data-large-file="https://i2.wp.com/itnerd.space/wp-content/uploads/2017/01/MakerActionServiceIFTTT.png?fit=310%2C310" class="size-thumbnail wp-image-209 alignright" src="https://i2.wp.com/itnerd.space/wp-content/uploads/2017/01/MakerActionServiceIFTTT.png?resize=150%2C150" alt="" srcset="https://i2.wp.com/itnerd.space/wp-content/uploads/2017/01/MakerActionServiceIFTTT.png?resize=150%2C150 150w, https://i2.wp.com/itnerd.space/wp-content/uploads/2017/01/MakerActionServiceIFTTT.png?resize=300%2C300 300w, https://i2.wp.com/itnerd.space/wp-content/uploads/2017/01/MakerActionServiceIFTTT.png?resize=30%2C30 30w, https://i2.wp.com/itnerd.space/wp-content/uploads/2017/01/MakerActionServiceIFTTT.png?resize=100%2C100 100w, https://i2.wp.com/itnerd.space/wp-content/uploads/2017/01/MakerActionServiceIFTTT.png?w=310 310w" sizes="(max-width: 150px) 100vw, 150px" data-recalc-dims="1" /><strong>Note:</strong> If you haven&#8217;t already, follow the steps in my <a href="http://itnerd.space/2017/01/22/how-to-control-your-tp-link-hs100-smartplug-from-internet/">previous post</a>, to figure out what your <em>Token</em> and <em>Device ID</em> are.</p>
<p>Then create a new <del>Recipe</del> Applet like you normally would in IFTTT, and choose the &#8220;<strong>Maker Webhook</strong> / Make a Web Request&#8221; action service to define a new action.</p>
<p>For the URL, I&#8217;ve used:</p>
<pre>https://eu-wap.tplinkcloud.com/?token=<span style="color: #800080;">YOUR_TOKEN_HERE</span></pre>
<p>and the method type is POST.</p>
<p><img data-attachment-id="308" data-permalink="http://itnerd.space/2017/01/22/control-your-tp-link-hs100-smart-plug-with-ifttt/error/" data-orig-file="https://i1.wp.com/itnerd.space/wp-content/uploads/2017/01/error.png?fit=512%2C512" data-orig-size="512,512" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="error" data-image-description="" data-medium-file="https://i1.wp.com/itnerd.space/wp-content/uploads/2017/01/error.png?fit=300%2C300" data-large-file="https://i1.wp.com/itnerd.space/wp-content/uploads/2017/01/error.png?fit=512%2C512" class="wp-image-308 alignleft" src="https://i1.wp.com/itnerd.space/wp-content/uploads/2017/01/error.png?resize=38%2C38" alt="" srcset="https://i1.wp.com/itnerd.space/wp-content/uploads/2017/01/error.png?resize=150%2C150 150w, https://i1.wp.com/itnerd.space/wp-content/uploads/2017/01/error.png?resize=300%2C300 300w, https://i1.wp.com/itnerd.space/wp-content/uploads/2017/01/error.png?resize=30%2C30 30w, https://i1.wp.com/itnerd.space/wp-content/uploads/2017/01/error.png?w=512 512w, https://i1.wp.com/itnerd.space/wp-content/uploads/2017/01/error.png?resize=100%2C100 100w" sizes="(max-width: 38px) 100vw, 38px" data-recalc-dims="1" /><strong>Note</strong>: For the URL: please read <a href="http://itnerd.space/2017/05/21/how-to-get-the-tp-link-hs100-cloud-end-point-url/">this other post</a>, as you might need to use a different URL depending the region where you are from.</p>
<p><a href="http://itnerd.space/wp-content/uploads/2017/01/screenshot-ifttt.com-2017-01-22-17-19-45.png"><br />
</a> <a href="https://i0.wp.com/itnerd.space/wp-content/uploads/2017/01/screenshot-ifttt.com-2017-01-22-17-19-27.png"><img data-attachment-id="211" data-permalink="http://itnerd.space/2017/01/22/control-your-tp-link-hs100-smart-plug-with-ifttt/screenshot-ifttt-com-2017-01-22-17-19-27/" data-orig-file="https://i0.wp.com/itnerd.space/wp-content/uploads/2017/01/screenshot-ifttt.com-2017-01-22-17-19-27.png?fit=501%2C615" data-orig-size="501,615" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="screenshot-ifttt.com-2017-01-22-17-19-27" data-image-description="" data-medium-file="https://i0.wp.com/itnerd.space/wp-content/uploads/2017/01/screenshot-ifttt.com-2017-01-22-17-19-27.png?fit=244%2C300" data-large-file="https://i0.wp.com/itnerd.space/wp-content/uploads/2017/01/screenshot-ifttt.com-2017-01-22-17-19-27.png?fit=501%2C615" class="aligncenter wp-image-211 size-full" src="https://i0.wp.com/itnerd.space/wp-content/uploads/2017/01/screenshot-ifttt.com-2017-01-22-17-19-27.png?resize=501%2C615" srcset="https://i0.wp.com/itnerd.space/wp-content/uploads/2017/01/screenshot-ifttt.com-2017-01-22-17-19-27.png?w=501 501w, https://i0.wp.com/itnerd.space/wp-content/uploads/2017/01/screenshot-ifttt.com-2017-01-22-17-19-27.png?resize=244%2C300 244w, https://i0.wp.com/itnerd.space/wp-content/uploads/2017/01/screenshot-ifttt.com-2017-01-22-17-19-27.png?resize=24%2C30 24w" sizes="(max-width: 501px) 100vw, 501px" data-recalc-dims="1" /></a></p>
<p>The Content Type is application/json, and the payload to switch the plug On should be:</p>
<pre>{"method":"passthrough",
"params": {"deviceId": "<span style="color: #800080;">YOUR_DEVICEID_HERE</span>",
"requestData": "{\"system\":{\"set_relay_state\":{\"state\":<strong><span style="color: #339966;">1</span></strong>}
}
}" }
}</pre>
<p><img data-attachment-id="210" data-permalink="http://itnerd.space/2017/01/22/control-your-tp-link-hs100-smart-plug-with-ifttt/screenshot-ifttt-com-2017-01-22-17-19-45/" data-orig-file="https://i2.wp.com/itnerd.space/wp-content/uploads/2017/01/screenshot-ifttt.com-2017-01-22-17-19-45.png?fit=440%2C471" data-orig-size="440,471" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="screenshot-ifttt.com-2017-01-22-17-19-45" data-image-description="" data-medium-file="https://i2.wp.com/itnerd.space/wp-content/uploads/2017/01/screenshot-ifttt.com-2017-01-22-17-19-45.png?fit=280%2C300" data-large-file="https://i2.wp.com/itnerd.space/wp-content/uploads/2017/01/screenshot-ifttt.com-2017-01-22-17-19-45.png?fit=440%2C471" class="aligncenter wp-image-210 size-full" src="https://i2.wp.com/itnerd.space/wp-content/uploads/2017/01/screenshot-ifttt.com-2017-01-22-17-19-45.png?resize=440%2C471" srcset="https://i2.wp.com/itnerd.space/wp-content/uploads/2017/01/screenshot-ifttt.com-2017-01-22-17-19-45.png?w=440 440w, https://i2.wp.com/itnerd.space/wp-content/uploads/2017/01/screenshot-ifttt.com-2017-01-22-17-19-45.png?resize=280%2C300 280w, https://i2.wp.com/itnerd.space/wp-content/uploads/2017/01/screenshot-ifttt.com-2017-01-22-17-19-45.png?resize=28%2C30 28w" sizes="(max-width: 440px) 100vw, 440px" data-recalc-dims="1" /></p>
<p>If you want to switch the plug Off, just replace the state 1 with state 0.</p>
<p>Notice how I have added extra carriage returns to separate the &#8220;}&#8221; at the end, otherwise IFTTT was giving me some error.</p>
<p>That&#8217;s it! Easy, right?</p>
]]></content:encoded>
			<wfw:commentRss>http://itnerd.space/2017/01/22/control-your-tp-link-hs100-smart-plug-with-ifttt/feed/</wfw:commentRss>
		<slash:comments>27</slash:comments>
	<post-id xmlns="com-wordpress:feed-additions:1">208</post-id>	</item>
		<item>
		<title>Azure App Service Architecture (4): Scalability</title>
		<link>http://itnerd.space/2016/11/13/azure-app-service-architecture-4-scalability/</link>
		<comments>http://itnerd.space/2016/11/13/azure-app-service-architecture-4-scalability/#respond</comments>
		<pubDate>Sun, 13 Nov 2016 20:21:10 +0000</pubDate>
		<dc:creator><![CDATA[Alex D.]]></dc:creator>
				<category><![CDATA[Cloud]]></category>
		<category><![CDATA[Architecture]]></category>
		<category><![CDATA[Azure]]></category>
		<category><![CDATA[PaaS]]></category>

		<guid isPermaLink="false">http://itnerd.space/?p=124</guid>
		<description><![CDATA[Azure App Service scalability: How do they do it? We usually understand well what scalability is, but how is it achieved technically?]]></description>
				<content:encoded><![CDATA[<blockquote><p><strong>Scalability</strong> is the capability of a system, network, or process to handle a growing amount of work, or its potential to be enlarged in order to accommodate that growth.</p></blockquote>
<p>Looking at scalability is very relevant in Cloud environment, which provide a high level of on demand elasticity and thus allow us to easily implement the scalability patterns most relevant to our applications to cater for our particular business needs, whichever they may be.</p>
<h3>App Service Plan Provisioning</h3>
<p>Let first have a look at what happen when you provision a new App Service Plan in Azure.</p>
<p>When you request the creation of an Azure Web App onto a new App Service Plan (aka. <em>Serverfarm</em>), Azure is not provisioning a brand new VM from scratch. Instead, I believe, they assign you a recycled VM of the chosen size, for example B1, from a pool of existing VM.</p>
<p><a href="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/11/App-Service-Plan-Provisioning.png"><img data-attachment-id="116" data-permalink="http://itnerd.space/2016/11/13/azure-app-service-architecture-4-scalability/app-service-plan-provisioning/" data-orig-file="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/11/App-Service-Plan-Provisioning.png?fit=587%2C493" data-orig-size="587,493" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="app-service-plan-provisioning" data-image-description="" data-medium-file="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/11/App-Service-Plan-Provisioning.png?fit=300%2C252" data-large-file="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/11/App-Service-Plan-Provisioning.png?fit=587%2C493" class="size-full wp-image-116 aligncenter" src="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/11/App-Service-Plan-Provisioning.png?resize=587%2C493" alt="app-service-plan-provisioning" srcset="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/11/App-Service-Plan-Provisioning.png?w=587 587w, https://i2.wp.com/itnerd.space/wp-content/uploads/2016/11/App-Service-Plan-Provisioning.png?resize=300%2C252 300w" sizes="(max-width: 587px) 100vw, 587px" data-recalc-dims="1" /></a></p>
<p>Indeed you can see that by looking at the uptime of the provisioned VM instance (use Kudu advanced tools): uptime is quite random, and not near 0. A near 0 uptime would indicate a recently created VM. So, in my understanding, Azure keeps a pool of VMs just ready for when a new customer is requesting a new service plan, or when a scaling operation is needed.</p>
<p>That make a lot of sense. Provisioning a new VM each time would take quite a lot of time, while a new Web App deployment actually happens in about 15 to 20 seconds. For that purpose, I assume they will always keep a certain number of VMs ready in the pool, enough to respond to customer&#8217;s needs at all time in a timely manner.</p>
<h3>Horizontal scalability (Scale out / Scale in)</h3>
<p>Horizontal scalability is when you change the number of VM instances supporting your App Service Plan. When load on your apps grows, you will likely scale-out (add more VM instances). When the loads decrease, you will scale back in, reducing the number of VM instances.</p>
<p>As I understand it, when scaling-out, an operation similar to the provisioning will happen: Azure will assign you one new VM of the same size, from its pool of available VMs:</p>
<p style="text-align: center;"><a href="https://i1.wp.com/itnerd.space/wp-content/uploads/2016/11/App-Service-Plan-Provisioning-Scale-Out.png"><img data-attachment-id="120" data-permalink="http://itnerd.space/2016/11/13/azure-app-service-architecture-4-scalability/app-service-plan-provisioning-scale-out/" data-orig-file="https://i1.wp.com/itnerd.space/wp-content/uploads/2016/11/App-Service-Plan-Provisioning-Scale-Out.png?fit=579%2C498" data-orig-size="579,498" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="app-service-plan-provisioning-scale-out" data-image-description="" data-medium-file="https://i1.wp.com/itnerd.space/wp-content/uploads/2016/11/App-Service-Plan-Provisioning-Scale-Out.png?fit=300%2C258" data-large-file="https://i1.wp.com/itnerd.space/wp-content/uploads/2016/11/App-Service-Plan-Provisioning-Scale-Out.png?fit=579%2C498" class="alignnone size-full wp-image-120" src="https://i1.wp.com/itnerd.space/wp-content/uploads/2016/11/App-Service-Plan-Provisioning-Scale-Out.png?resize=579%2C498" alt="app-service-plan-provisioning-scale-out" srcset="https://i1.wp.com/itnerd.space/wp-content/uploads/2016/11/App-Service-Plan-Provisioning-Scale-Out.png?w=579 579w, https://i1.wp.com/itnerd.space/wp-content/uploads/2016/11/App-Service-Plan-Provisioning-Scale-Out.png?resize=300%2C258 300w" sizes="(max-width: 579px) 100vw, 579px" data-recalc-dims="1" /></a></p>
<p>When the plan scales back in again, the VM is removed from the Plan and placed back in the correspondin pool. As I understand it, it is recycled so it can be reused again, possibly by another customer.</p>
<p><a href="https://i1.wp.com/itnerd.space/wp-content/uploads/2016/11/App-Service-Plan-Provisioning-Scale-In.png"><img data-attachment-id="119" data-permalink="http://itnerd.space/2016/11/13/azure-app-service-architecture-4-scalability/app-service-plan-provisioning-scale-in/" data-orig-file="https://i1.wp.com/itnerd.space/wp-content/uploads/2016/11/App-Service-Plan-Provisioning-Scale-In.png?fit=583%2C493" data-orig-size="583,493" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="app-service-plan-provisioning-scale-in" data-image-description="" data-medium-file="https://i1.wp.com/itnerd.space/wp-content/uploads/2016/11/App-Service-Plan-Provisioning-Scale-In.png?fit=300%2C254" data-large-file="https://i1.wp.com/itnerd.space/wp-content/uploads/2016/11/App-Service-Plan-Provisioning-Scale-In.png?fit=583%2C493" class="size-full wp-image-119 aligncenter" src="https://i1.wp.com/itnerd.space/wp-content/uploads/2016/11/App-Service-Plan-Provisioning-Scale-In.png?resize=583%2C493" alt="app-service-plan-provisioning-scale-in" srcset="https://i1.wp.com/itnerd.space/wp-content/uploads/2016/11/App-Service-Plan-Provisioning-Scale-In.png?w=583 583w, https://i1.wp.com/itnerd.space/wp-content/uploads/2016/11/App-Service-Plan-Provisioning-Scale-In.png?resize=300%2C254 300w" sizes="(max-width: 583px) 100vw, 583px" data-recalc-dims="1" /></a></p>
<h3>Vertical scalability (Scale up/down)</h3>
<p>Vertical scalability is about changing the App Service Plan instance size. If you need more compute power to run you apps, you can choose to scale-up your plan to bigger VM(s). What happen in that case though?</p>
<p><a href="https://i0.wp.com/itnerd.space/wp-content/uploads/2016/11/App-Service-Plan-Provisioning-Scale-Up-1.png"><img data-attachment-id="118" data-permalink="http://itnerd.space/2016/11/13/azure-app-service-architecture-4-scalability/app-service-plan-provisioning-scale-up-1/" data-orig-file="https://i0.wp.com/itnerd.space/wp-content/uploads/2016/11/App-Service-Plan-Provisioning-Scale-Up-1.png?fit=485%2C225" data-orig-size="485,225" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="app-service-plan-provisioning-scale-up-1" data-image-description="" data-medium-file="https://i0.wp.com/itnerd.space/wp-content/uploads/2016/11/App-Service-Plan-Provisioning-Scale-Up-1.png?fit=300%2C139" data-large-file="https://i0.wp.com/itnerd.space/wp-content/uploads/2016/11/App-Service-Plan-Provisioning-Scale-Up-1.png?fit=485%2C225" class="size-full wp-image-118 aligncenter" src="https://i0.wp.com/itnerd.space/wp-content/uploads/2016/11/App-Service-Plan-Provisioning-Scale-Up-1.png?resize=485%2C225" alt="app-service-plan-provisioning-scale-up-1" srcset="https://i0.wp.com/itnerd.space/wp-content/uploads/2016/11/App-Service-Plan-Provisioning-Scale-Up-1.png?w=485 485w, https://i0.wp.com/itnerd.space/wp-content/uploads/2016/11/App-Service-Plan-Provisioning-Scale-Up-1.png?resize=300%2C139 300w" sizes="(max-width: 485px) 100vw, 485px" data-recalc-dims="1" /></a><br />
AFAIK, Azure runs on Hyper-V virtualization platform, and at the time of this writing, Hyper-V doesn&#8217;t allow for dynamic CPU/RAM resizing of VMs. So how do they do it?</p>
<p>Well, I did the test on a Plan with a single small instance. I noticed the instance hostname and uptime before scaling up. I then scaled the plan up to medium, and guess what: the hostname and uptime of the only instance in the plan was totally different!</p>
<p>Here&#8217;s my educated guess: Azure assigned a medium VM from the pool of medium VM and added it to the Plan (1). All the Apps running in the plan started to run in that new VM as well. Only then, the small VM got removed from the Plan (2), leaving the plan with a single Medium VM.<br />
<a href="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/11/App-Service-Plan-Provisioning-Scale-Up-2.png"><img data-attachment-id="117" data-permalink="http://itnerd.space/2016/11/13/azure-app-service-architecture-4-scalability/app-service-plan-provisioning-scale-up-2/" data-orig-file="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/11/App-Service-Plan-Provisioning-Scale-Up-2.png?fit=642%2C369" data-orig-size="642,369" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="app-service-plan-provisioning-scale-up-2" data-image-description="" data-medium-file="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/11/App-Service-Plan-Provisioning-Scale-Up-2.png?fit=300%2C172" data-large-file="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/11/App-Service-Plan-Provisioning-Scale-Up-2.png?fit=642%2C369" class="size-full wp-image-117 aligncenter" src="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/11/App-Service-Plan-Provisioning-Scale-Up-2.png?resize=642%2C369" alt="app-service-plan-provisioning-scale-up-2" srcset="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/11/App-Service-Plan-Provisioning-Scale-Up-2.png?w=642 642w, https://i2.wp.com/itnerd.space/wp-content/uploads/2016/11/App-Service-Plan-Provisioning-Scale-Up-2.png?resize=300%2C172 300w" sizes="(max-width: 642px) 100vw, 642px" data-recalc-dims="1" /></a><br />
We can also easily figure how it would happen with more than one VM. Scaling back in would also happen similarly.</p>
]]></content:encoded>
			<wfw:commentRss>http://itnerd.space/2016/11/13/azure-app-service-architecture-4-scalability/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
	<post-id xmlns="com-wordpress:feed-additions:1">124</post-id>	</item>
		<item>
		<title>Azure App Service Architecture (3): App Service on Linux</title>
		<link>http://itnerd.space/2016/11/02/azure-app-service-architecture-3-app-service-on-linux/</link>
		<comments>http://itnerd.space/2016/11/02/azure-app-service-architecture-3-app-service-on-linux/#comments</comments>
		<pubDate>Wed, 02 Nov 2016 20:24:53 +0000</pubDate>
		<dc:creator><![CDATA[Alex D.]]></dc:creator>
				<category><![CDATA[Cloud]]></category>
		<category><![CDATA[Linux]]></category>
		<category><![CDATA[Architecture]]></category>
		<category><![CDATA[Azure]]></category>
		<category><![CDATA[docker]]></category>
		<category><![CDATA[PaaS]]></category>

		<guid isPermaLink="false">http://itnerd.space/?p=82</guid>
		<description><![CDATA[Discover how Microsoft is leveraging Ubuntu and Docker to implement their new Azure PaaS offering: "App Service on Linux".]]></description>
				<content:encoded><![CDATA[<p>Until now, Azure customers could deploy their Web Applications running PHP, Node.js,&#8230; on Windows server running IIS, but now they will have a choice to run them on Linux: Microsoft recently announced the availability, in <em>Public Preview</em> mode, of <strong><a href="http://itnerd.space/2016/11/02/azure-app-service-architecture-3-app-service-on-linux/">App Service on Linux</a></strong>:</p>
<blockquote><p><a href="http://itnerd.space/2016/11/02/azure-app-service-architecture-3-app-service-on-linux/">App Service on Linux</a> is currently in Public Preview and enables customers to run their web apps natively on a Linux platform. This allows for better application compatibility for certain kinds of applications and makes it easier to migrate existing web apps hosted on a Linux platform elsewhere onto Azure App Services.</p></blockquote>
<p><span id="more-82"></span></p>
<p>In this third post in my series on Azure <a href="http://itnerd.space/?s=Azure+App+Service+Architecture">App Service Architecture</a>, I&#8217;ll focus on how Microsoft implemented this new Platform as a Service product. What will actually run your app if you deploy it on Linux, what Linux distribution they have chose, and how are all the apps deployed on those underlying Linux servers. If you haven&#8217;t read my preview two articles, I strongly recommend you read them first: <a href="http://itnerd.space/2016/10/28/azure-app-service-architecture-1/">Azure App Service Architecture (1)</a> and <a href="http://itnerd.space/2016/10/29/azure-app-service-architecture-2/">Azure App Service Architecture (2)</a> as they will explain some basic concepts that are used in this one.</p>
<h1><strong>Provisioning a Web App on Linux</strong></h1>
<p>This part is really trivial. I&#8217;ll show some screenshots, but they are self explaining. Let&#8217;s click on the [+] button, and head to [Web + Mobile]. From there, we&#8217;ll select <strong>Web App on Linux (Preview)</strong>:</p>
<p><a href="https://i0.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-02-13_51_43-Choose-your-pricing-tier-Microsoft-Azure.png"><img data-attachment-id="78" data-permalink="http://itnerd.space/2016/11/02/azure-app-service-architecture-3-app-service-on-linux/2016-11-02-13_51_43-choose-your-pricing-tier-microsoft-azure/" data-orig-file="https://i0.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-02-13_51_43-Choose-your-pricing-tier-Microsoft-Azure.png?fit=696%2C765" data-orig-size="696,765" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="2016-11-02-13_51_43-choose-your-pricing-tier-microsoft-azure" data-image-description="" data-medium-file="https://i0.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-02-13_51_43-Choose-your-pricing-tier-Microsoft-Azure.png?fit=273%2C300" data-large-file="https://i0.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-02-13_51_43-Choose-your-pricing-tier-Microsoft-Azure.png?fit=696%2C765" class="alignnone size-full wp-image-78" src="https://i0.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-02-13_51_43-Choose-your-pricing-tier-Microsoft-Azure.png?resize=696%2C765" alt="2016-11-02-13_51_43-choose-your-pricing-tier-microsoft-azure" srcset="https://i0.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-02-13_51_43-Choose-your-pricing-tier-Microsoft-Azure.png?w=696 696w, https://i0.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-02-13_51_43-Choose-your-pricing-tier-Microsoft-Azure.png?resize=273%2C300 273w" sizes="(max-width: 696px) 100vw, 696px" data-recalc-dims="1" /></a></p>
<p>I&#8217;ll set a new unique name for my new Web App:</p>
<p><img data-attachment-id="73" data-permalink="http://itnerd.space/2016/11/02/azure-app-service-architecture-3-app-service-on-linux/2016-11-02-13_51_51-choose-your-pricing-tier-microsoft-azure/" data-orig-file="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-02-13_51_51-Choose-your-pricing-tier-Microsoft-Azure.png?fit=317%2C653" data-orig-size="317,653" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="2016-11-02-13_51_51-choose-your-pricing-tier-microsoft-azure" data-image-description="" data-medium-file="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-02-13_51_51-Choose-your-pricing-tier-Microsoft-Azure.png?fit=146%2C300" data-large-file="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-02-13_51_51-Choose-your-pricing-tier-Microsoft-Azure.png?fit=317%2C653" class="alignnone size-full wp-image-73" src="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-02-13_51_51-Choose-your-pricing-tier-Microsoft-Azure.png?resize=317%2C653" alt="2016-11-02-13_51_51-choose-your-pricing-tier-microsoft-azure" srcset="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-02-13_51_51-Choose-your-pricing-tier-Microsoft-Azure.png?w=317 317w, https://i2.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-02-13_51_51-Choose-your-pricing-tier-Microsoft-Azure.png?resize=146%2C300 146w" sizes="(max-width: 317px) 100vw, 317px" data-recalc-dims="1" /></p>
<p>To be able to explore a little further the options available to us, I&#8217;ll choose to create a new App Service Plan, instead of using the default recommended to me. Notice that while the product is in Preview, it is not available in all Azure regions yet. In Europe it&#8217;s only available in West Europe for example. That&#8217;s enough for me to test it anyway.</p>
<p><a href="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-02-13_52_13-Choose-your-pricing-tier-Microsoft-Azure.png"><img data-attachment-id="77" data-permalink="http://itnerd.space/2016/11/02/azure-app-service-architecture-3-app-service-on-linux/2016-11-02-13_52_13-choose-your-pricing-tier-microsoft-azure/" data-orig-file="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-02-13_52_13-Choose-your-pricing-tier-Microsoft-Azure.png?fit=899%2C718" data-orig-size="899,718" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="2016-11-02-13_52_13-choose-your-pricing-tier-microsoft-azure" data-image-description="" data-medium-file="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-02-13_52_13-Choose-your-pricing-tier-Microsoft-Azure.png?fit=300%2C240" data-large-file="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-02-13_52_13-Choose-your-pricing-tier-Microsoft-Azure.png?fit=700%2C559" class="alignnone size-full wp-image-77" src="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-02-13_52_13-Choose-your-pricing-tier-Microsoft-Azure.png?resize=700%2C559" alt="2016-11-02-13_52_13-choose-your-pricing-tier-microsoft-azure" srcset="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-02-13_52_13-Choose-your-pricing-tier-Microsoft-Azure.png?w=899 899w, https://i2.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-02-13_52_13-Choose-your-pricing-tier-Microsoft-Azure.png?resize=300%2C240 300w, https://i2.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-02-13_52_13-Choose-your-pricing-tier-Microsoft-Azure.png?resize=768%2C613 768w" sizes="(max-width: 700px) 100vw, 700px" data-recalc-dims="1" /></a></p>
<p>Particularly, I don&#8217;t need to pay for a Standard plan, so I&#8217;ll choose a Basic B1 here.</p>
<p><img data-attachment-id="76" data-permalink="http://itnerd.space/2016/11/02/azure-app-service-architecture-3-app-service-on-linux/2016-11-02-13_52_31-web-app-on-linux-preview-microsoft-azure/" data-orig-file="https://i1.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-02-13_52_31-Web-App-On-Linux-preview-Microsoft-Azure.png?fit=317%2C718" data-orig-size="317,718" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="2016-11-02-13_52_31-web-app-on-linux-preview-microsoft-azure" data-image-description="" data-medium-file="https://i1.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-02-13_52_31-Web-App-On-Linux-preview-Microsoft-Azure.png?fit=132%2C300" data-large-file="https://i1.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-02-13_52_31-Web-App-On-Linux-preview-Microsoft-Azure.png?fit=317%2C718" class="alignnone size-full wp-image-76" src="https://i1.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-02-13_52_31-Web-App-On-Linux-preview-Microsoft-Azure.png?resize=317%2C718" alt="2016-11-02-13_52_31-web-app-on-linux-preview-microsoft-azure" srcset="https://i1.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-02-13_52_31-Web-App-On-Linux-preview-Microsoft-Azure.png?w=317 317w, https://i1.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-02-13_52_31-Web-App-On-Linux-preview-Microsoft-Azure.png?resize=132%2C300 132w" sizes="(max-width: 317px) 100vw, 317px" data-recalc-dims="1" /></p>
<p>So here we go, just click the Create button, and in less than a minute, you&#8217;ll have a Web App up and running, ready for you to use to deploy your app, using your favorite Deployment method, Git, FTP&#8230;</p>
<h1><strong>App Service on Linux Architecture</strong></h1>
<p>To better understand what has been deployed by Azure, let&#8217;s head to the Development tools section of the Web App setting menu, and select Advanced Tools:</p>
<p><a href="https://i1.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-02-14_20_37-Advanced-Tools-Microsoft-Azure.png"><img data-attachment-id="84" data-permalink="http://itnerd.space/2016/11/02/azure-app-service-architecture-3-app-service-on-linux/2016-11-02-14_20_37-advanced-tools-microsoft-azure/" data-orig-file="https://i1.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-02-14_20_37-Advanced-Tools-Microsoft-Azure.png?fit=647%2C447" data-orig-size="647,447" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="2016-11-02-14_20_37-advanced-tools-microsoft-azure" data-image-description="" data-medium-file="https://i1.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-02-14_20_37-Advanced-Tools-Microsoft-Azure.png?fit=300%2C207" data-large-file="https://i1.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-02-14_20_37-Advanced-Tools-Microsoft-Azure.png?fit=647%2C447" class="alignnone size-full wp-image-84" src="https://i1.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-02-14_20_37-Advanced-Tools-Microsoft-Azure.png?resize=647%2C447" alt="2016-11-02-14_20_37-advanced-tools-microsoft-azure" srcset="https://i1.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-02-14_20_37-Advanced-Tools-Microsoft-Azure.png?w=647 647w, https://i1.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-02-14_20_37-Advanced-Tools-Microsoft-Azure.png?resize=300%2C207 300w, https://i1.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-02-14_20_37-Advanced-Tools-Microsoft-Azure.png?resize=230%2C160 230w" sizes="(max-width: 647px) 100vw, 647px" data-recalc-dims="1" /></a></p>
<p>Then click on the Go link. It will open the traditional Kudu tools console, where we will have access to some internal information regarding our Web App.</p>
<h2>Application layer</h2>
<p>First let&#8217;s figure out what we have at the Application layer. That is, what kind of software is going to serve our application. In this case, from the Environment tab, we can see some interesting Server Environment Variables:</p>
<pre>SERVER_SOFTWARE=Apache/2.4.10 (Debian)</pre>
<p>So apparently the Web App is deployed on <strong>Apache 2.4 </strong>on<strong> Debian</strong>.</p>
<p>Let&#8217;s dig a little deeper with the Bash console, and have a look at the processes we can see:</p>
<pre>Kudu Remote Execution Console
Type 'exit' to reset this console.
/home&gt; ps -ef
UID PID PPID C STIME TTY TIME CMD
1001 1 0 0 12:54 ? 00:00:00 /bin/sh -c /usr/sbin/apache2ctl -D FOREGROUND
1001 5 1 0 12:54 ? 00:00:00 /bin/sh /usr/sbin/apache2ctl -D FOREGROUND
1001 7 5 0 12:54 ? 00:00:00 /usr/sbin/apache2 -D FOREGROUND
1001 9 1 0 12:54 ? 00:00:00 /usr/bin/mono /usr/lib/mono/4.5/mod-mono-server4.exe --filename /tmp/.mod_mono_server4 --nonstop --appconfigdir /etc/mono-server4
1001 12 7 0 12:54 ? 00:00:00 /usr/sbin/apache2 -D FOREGROUND
1001 13 7 0 12:54 ? 00:00:00 /usr/sbin/apache2 -D FOREGROUND
1001 71 1 6 12:54 ? 00:00:08 /usr/bin/mono /usr/lib/mono/4.5/mod-mono-server4.exe --filename /tmp/mod_mono_server_default --applications /:/opt/Kudu --nonstop
1001 126 71 0 12:56 ? 00:00:00 /bin/bash -c ps -ef &amp;&amp; echo &amp;&amp; pwd
1001 127 126 0 12:56 ? 00:00:00 ps -ef</pre>
<p>We can see very few processes running, and especially interesting, the PID 1 is apache2ctl, so we are most likely running is a container (if we were in a full server, it would be &#8220;init&#8221;). All the processes run as a non-root user (uid 1001).</p>
<p>We can indeed confirm that our Web App is running inside a Docker container by looking at /proc/1/cgroup:</p>
<pre>/home&gt; cat /proc/1/cgroup
11:memory:<strong>/docker/</strong>fb05a97d54930566111197c8959a5a33ac9af29b6491bf1ca8158b18df50264b
10:cpuset:/docker/fb05a97d54930566111197c8959a5a33ac9af29b6491bf1ca8158b18df50264b
9:hugetlb:/docker/fb05a97d54930566111197c8959a5a33ac9af29b6491bf1ca8158b18df50264b
8:blkio:/docker/fb05a97d54930566111197c8959a5a33ac9af29b6491bf1ca8158b18df50264b
7:perf_event:/docker/fb05a97d54930566111197c8959a5a33ac9af29b6491bf1ca8158b18df50264b
6:net_cls,net_prio:/docker/fb05a97d54930566111197c8959a5a33ac9af29b6491bf1ca8158b18df50264b
5:pids:/docker/fb05a97d54930566111197c8959a5a33ac9af29b6491bf1ca8158b18df50264b
4:cpu,cpuacct:/docker/fb05a97d54930566111197c8959a5a33ac9af29b6491bf1ca8158b18df50264b
3:freezer:/docker/fb05a97d54930566111197c8959a5a33ac9af29b6491bf1ca8158b18df50264b
2:devices:/docker/fb05a97d54930566111197c8959a5a33ac9af29b6491bf1ca8158b18df50264b
1:name=systemd:/docker/fb05a97d54930566111197c8959a5a33ac9af29b6491bf1ca8158b18df50264b</pre>
<p>So, Web App on Linux are deployed in <strong>Docker containers</strong> (and we know the ID of the container in the host).</p>
<p>Unfortunately, there&#8217;s not much we can do from inside the Docker container itself to guess anything about the host running the Docker engine, so we don&#8217;t really know what is the OS flavor, version or anything else.</p>
<p>We can have a look at the kernel, which is shared between the VM (host) and all the containers run in the same VM:</p>
<pre class="jquery-console-prompt-box"><span class="jquery-console-prompt-label">/home&gt;</span><span class="jquery-console-prompt"> uname -a</span>
Linux e30a13645e09 4.4.0-45-generic #66-Ubuntu SMP Wed Oct 19 14:12:37 UTC 2016 x86_64 GNU/Linux</pre>
<div class="jquery-console-message jquery-console-message-value">So it looks like it it might be some version of Ubuntu, likely 16.04 (Xenial), where 4.4.0-45-generic #66 is available (<del>although it could also be 14.04</del>). Confirmed by Nalim, Software Engineer at Microsoft, they are using Ubuntu 16.04 for the hosts (VM instances), see comments below.</div>
<p>Regarding the Docker image that was used, we can see it&#8217;s based on <strong>Debian 8 (Jessie)</strong>:</p>
<pre>/home&gt; cat /etc/os-release
PRETTY_NAME="Debian GNU/Linux 8 (jessie)"
NAME="Debian GNU/Linux"
VERSION_ID="8"
VERSION="8 (jessie)"
ID=debian
HOME_URL="http://www.debian.org/"
SUPPORT_URL="http://www.debian.org/support"
BUG_REPORT_URL="https://bugs.debian.org/"</pre>
<h2><strong>Data layer: Persistent Storage?</strong></h2>
<p>Storage inside a Docker container is, usually, volatile, but if we deploy our App there, we don&#8217;t want to loose it when the container stops or the host reboots. Also, we want to be able to scale out our Web App when load increase. So we require some kind of persistency!</p>
<p>Similarly to Web App on Windows, where the persisted files are found in D:\home, here we&#8217;ll store the Persisted files in /home. As this Web App is recently created, it&#8217;s actually quite empty right now:</p>
<pre class="jquery-console-prompt-box"><span class="jquery-console-prompt-label">/home&gt;</span><span class="jquery-console-prompt">pwd
</span>/home
<span class="jquery-console-prompt-label">/home&gt;</span><span class="jquery-console-prompt">ls</span>
LogFiles site</pre>
<p>So how is the storage actually persisted?</p>
<pre>/home&gt; mount | grep /home
//10.0.176.8/volume-46-default/20a35f31f26928286ecf/580efcc549c040228b254d82ab4ed6e1 on /home type cifs (rw,relatime,vers=3.0,sec=ntlmssp,cache=strict,username=dummyadmin,domain=RD0003FF1A594C,uid=1001,forceuid,gid=1002,forcegid,addr=10.0.176.8,file_mode=0700,dir_mode=0700,nounix,serverino,mapposix,mfsymlinks,rsize=1048576,wsize=1048576,actimeo=1)</pre>
<p>We can see that the /home directory is actually a network shared volume mounted via CIFS protocol (I can only assume here it&#8217;s backed by Azure Storage). That way Azure will be able to scale out our Web App, deploying more containers based on the very same <em>stateless image</em>, mounting the same volume which is where our Web App files are deployed.</p>
<p><del>I think Microsoft might be using here a custom implementation of their <a title="" href="https://github.com/Azure/azurefile-dockervolumedriver">Docker Volume Plugin for Azure File Storage</a>. (I haven&#8217;t had time yet to play with it and see how similar (or not) things look with this Docker storage plugin).</del> For the persistent storage, Microsoft is using Fileservers that export SMB shares mounted in the host. Those are then mapped as /home into the corresponding docker containers.</p>
<p><strong>Putting everything together</strong></p>
<p>Let step back now. This is how I see Microsoft implemented <a href="http://itnerd.space/2016/11/02/azure-app-service-architecture-3-app-service-on-linux/">App Service on Linux</a>. First when we only deploy 1 web app on a single instance:</p>
<p><a href="https://i1.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-04-12_20_12-Azure_App_Services-Architecture.vsd-Microsoft-Visio.png"><img data-attachment-id="101" data-permalink="http://itnerd.space/2016/11/02/azure-app-service-architecture-3-app-service-on-linux/2016-11-04-12_20_12-azure_app_services-architecture-vsd-microsoft-visio/" data-orig-file="https://i1.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-04-12_20_12-Azure_App_Services-Architecture.vsd-Microsoft-Visio.png?fit=380%2C676" data-orig-size="380,676" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Azure App Service Architecture on Linux (single App &#038; Instance)" data-image-description="" data-medium-file="https://i1.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-04-12_20_12-Azure_App_Services-Architecture.vsd-Microsoft-Visio.png?fit=169%2C300" data-large-file="https://i1.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-04-12_20_12-Azure_App_Services-Architecture.vsd-Microsoft-Visio.png?fit=380%2C676" class="size-full wp-image-101 aligncenter" src="https://i1.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-04-12_20_12-Azure_App_Services-Architecture.vsd-Microsoft-Visio.png?resize=380%2C676" alt="Azure App Service Architecture on Linux (single App &amp; Instance)" srcset="https://i1.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-04-12_20_12-Azure_App_Services-Architecture.vsd-Microsoft-Visio.png?w=380 380w, https://i1.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-04-12_20_12-Azure_App_Services-Architecture.vsd-Microsoft-Visio.png?resize=169%2C300 169w" sizes="(max-width: 380px) 100vw, 380px" data-recalc-dims="1" /></a></p>
<p>Now, how does it look likes if we deploy multiple Web Apps in the same plan, and we scale out the Plan to two instances?</p>
<p><a href="https://i1.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-04-12_30_15-Azure_App_Services-Architecture.vsd-Microsoft-Visio.png"><img data-attachment-id="105" data-permalink="http://itnerd.space/2016/11/02/azure-app-service-architecture-3-app-service-on-linux/2016-11-04-12_30_15-azure_app_services-architecture-vsd-microsoft-visio/" data-orig-file="https://i1.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-04-12_30_15-Azure_App_Services-Architecture.vsd-Microsoft-Visio.png?fit=1045%2C649" data-orig-size="1045,649" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Azure App Service Architecture on Linux (multiple Apps &#038; Instances)" data-image-description="" data-medium-file="https://i1.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-04-12_30_15-Azure_App_Services-Architecture.vsd-Microsoft-Visio.png?fit=300%2C186" data-large-file="https://i1.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-04-12_30_15-Azure_App_Services-Architecture.vsd-Microsoft-Visio.png?fit=700%2C435" class="alignnone size-full wp-image-105" src="https://i1.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-04-12_30_15-Azure_App_Services-Architecture.vsd-Microsoft-Visio.png?resize=700%2C435" alt="Azure App Service Architecture on Linux (multiple Apps &amp; Instances)" srcset="https://i1.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-04-12_30_15-Azure_App_Services-Architecture.vsd-Microsoft-Visio.png?w=1045 1045w, https://i1.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-04-12_30_15-Azure_App_Services-Architecture.vsd-Microsoft-Visio.png?resize=300%2C186 300w, https://i1.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-04-12_30_15-Azure_App_Services-Architecture.vsd-Microsoft-Visio.png?resize=768%2C477 768w, https://i1.wp.com/itnerd.space/wp-content/uploads/2016/11/2016-11-04-12_30_15-Azure_App_Services-Architecture.vsd-Microsoft-Visio.png?resize=1024%2C636 1024w" sizes="(max-width: 700px) 100vw, 700px" data-recalc-dims="1" /></a></p>
<p>I hope this gave you a good understanding of how Microsoft implemented internally this new <a href="http://itnerd.space/2016/11/02/azure-app-service-architecture-3-app-service-on-linux/">App Service on Linux</a> product.</p>
]]></content:encoded>
			<wfw:commentRss>http://itnerd.space/2016/11/02/azure-app-service-architecture-3-app-service-on-linux/feed/</wfw:commentRss>
		<slash:comments>6</slash:comments>
	<post-id xmlns="com-wordpress:feed-additions:1">82</post-id>	</item>
		<item>
		<title>Azure App Service Architecture (2)</title>
		<link>http://itnerd.space/2016/10/29/azure-app-service-architecture-2/</link>
		<comments>http://itnerd.space/2016/10/29/azure-app-service-architecture-2/#comments</comments>
		<pubDate>Sat, 29 Oct 2016 17:34:21 +0000</pubDate>
		<dc:creator><![CDATA[Alex D.]]></dc:creator>
				<category><![CDATA[Cloud]]></category>
		<category><![CDATA[Architecture]]></category>
		<category><![CDATA[Azure]]></category>
		<category><![CDATA[PaaS]]></category>

		<guid isPermaLink="false">http://itnerd.space/?p=47</guid>
		<description><![CDATA[This is the second post of a series, on Azure App Service Architecture. The first one introduced the concepts of App and Plan, what are the Pricing Tiers and Instance Sizes. This one will give some more details on how I understand the service plan are architected internally.After working with Azure webapps and&#8230; ]]></description>
				<content:encoded><![CDATA[<p><em>This is the second post of a series, on Azure <a href="http://itnerd.space/?s=Azure+App+Service+Architecture">App Service Architecture</a>. The <a href="/2016/10/28/azure-app-service-architecture-1/">first one</a> introduced the concepts of App and Plan, what are the Pricing Tiers and Instance Sizes. This one will give some more details on how I understand the service plan are architected internally.</em><span id="more-47"></span>After working with Azure webapps and looking for more detailed information of how they are implemented in Azure, this is my understanding of how Azure App Services solution is architected internally.</p>
<p><em><strong>Note</strong>: This article is based solely on information gathered from publicly available sources, mainly Microsoft Azure documentation site and Github, wrapped with my own understanding and conclusions.</em></p>
<p>Let&#8217;s have a look at what an App Service Plan is actually made of.</p>
<p><strong>Compute</strong></p>
<p>We&#8217;ve seen in the first post that the App Service Plan is formed of one or more VMs instances (which can be dedicated or shared depending on the Service Tier). Also we&#8217;ve seen you can deploy multiple apps to the same Plan. The apps will then all run on all the instances of the Plan.</p>
<p>Inside each VM Instance of the Plan, you Apps are deployed in Sandboxes:</p>
<ul>
<li><strong>Sandbox mechanism</strong></li>
</ul>
<p>Azure App Services run in a secure environment called a sandbox. Each app runs inside its own sandbox, isolating its execution from other instances on the same machine as well as providing an additional degree of security and privacy.</p>
<p>The sandbox mechanism mitigates the risk of service disruption due to resource contention and depletion in two ways: it ensures that each app receives a minimum guarantee of resources and quality-of-service, and conversely enforces limits so that an app can not disrupt other concurrently-executing apps on the same machine.</p>
<p><strong>Storage</strong></p>
<p>From a storage perspective, and especially when it comes to scale-out (horizontally), it comes handy to understand what are the storage capabilities available to an App deployed in an App Service Plan. There are two kinds: Temporary storage, and Persisted storage.</p>
<ul>
<li><strong>Temporary files</strong></li>
</ul>
<p>Whithin the context of the Application deployed in the WebApp, a number of common Windows locations are using temporary storage on the local machine. For instance:</p>
<p>%APPDATA% points to something like D:\local\AppData.<br />
%TMP% goes to D:\local\Temp.</p>
<p>Unlike Persisted files, these files are not shared among site instances. Also, you cannot rely on them staying there. For instance, if you stop a site and restart it, you&#8217;ll find that all of these folders get reset to their original state.</p>
<ul>
<li><strong>Persisted files</strong></li>
</ul>
<p>Every Azure Web App has a home directory stored/backed by Azure Storage. This network share is where applications store their content. The sandbox implements a dynamic symbolic link in kernel mode which maps d:\home to the customer home directory.</p>
<p>These files are shared between all instances of your site (when you scale it up to multiple instances). Internally, the way this works is that they are stored in Azure Storage instead of living on the local file system. They are rooted in d:\home, which can also be found using the %HOME% environment variable.</p>
<p><strong><a href="http://itnerd.space/?s=Azure+App+Service+Architecture">App Service Architecture</a></strong></p>
<p>Now if we put everything together, let&#8217;s have a look at how it looks. First let&#8217;s start with a single App deployed on a Service Plan with a single VM Instance:</p>
<p><a href="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/10/Azure-App-Service-Plan-1app1instance.png"><img data-attachment-id="41" data-permalink="http://itnerd.space/2016/10/28/azure-app-service-architecture-1/azure-app-service-plan-1app1instance/" data-orig-file="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/10/Azure-App-Service-Plan-1app1instance.png?fit=197%2C476" data-orig-size="197,476" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="azure-app-service-plan-1app1instance" data-image-description="" data-medium-file="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/10/Azure-App-Service-Plan-1app1instance.png?fit=124%2C300" data-large-file="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/10/Azure-App-Service-Plan-1app1instance.png?fit=197%2C476" class="size-full wp-image-41 aligncenter" src="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/10/Azure-App-Service-Plan-1app1instance.png?resize=197%2C476" alt="azure-app-service-plan-1app1instance" srcset="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/10/Azure-App-Service-Plan-1app1instance.png?w=197 197w, https://i2.wp.com/itnerd.space/wp-content/uploads/2016/10/Azure-App-Service-Plan-1app1instance.png?resize=124%2C300 124w" sizes="(max-width: 197px) 100vw, 197px" data-recalc-dims="1" /></a></p>
<p>Now let&#8217;s see how it looks when we scale-out the plan to two VM instances. We can see how each instance of the App will have a separate Temporary storage in each VM, while they share the Persisted storage (where the App files are deployed).</p>
<p><a href="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/10/Azure-App-Service-Plan-1app2instance.png"><img data-attachment-id="40" data-permalink="http://itnerd.space/2016/10/28/azure-app-service-architecture-1/azure-app-service-plan-1app2instance/" data-orig-file="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/10/Azure-App-Service-Plan-1app2instance.png?fit=379%2C476" data-orig-size="379,476" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="azure-app-service-plan-1app2instance" data-image-description="" data-medium-file="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/10/Azure-App-Service-Plan-1app2instance.png?fit=239%2C300" data-large-file="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/10/Azure-App-Service-Plan-1app2instance.png?fit=379%2C476" class="size-full wp-image-40 aligncenter" src="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/10/Azure-App-Service-Plan-1app2instance.png?resize=379%2C476" alt="azure-app-service-plan-1app2instance" srcset="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/10/Azure-App-Service-Plan-1app2instance.png?w=379 379w, https://i2.wp.com/itnerd.space/wp-content/uploads/2016/10/Azure-App-Service-Plan-1app2instance.png?resize=239%2C300 239w" sizes="(max-width: 379px) 100vw, 379px" data-recalc-dims="1" /></a></p>
<p>&nbsp;</p>
<p>How does it look if we now deploy multiple Apps to this same App Service Plan?</p>
<p><a href="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/10/Azure-App-Service-Plan-3app2instance.png"><img data-attachment-id="39" data-permalink="http://itnerd.space/2016/10/28/azure-app-service-architecture-1/azure-app-service-plan-3app2instance/" data-orig-file="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/10/Azure-App-Service-Plan-3app2instance.png?fit=795%2C480" data-orig-size="795,480" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="azure-app-service-plan-3app2instance" data-image-description="" data-medium-file="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/10/Azure-App-Service-Plan-3app2instance.png?fit=300%2C181" data-large-file="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/10/Azure-App-Service-Plan-3app2instance.png?fit=700%2C423" class="size-full wp-image-39 aligncenter" src="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/10/Azure-App-Service-Plan-3app2instance.png?resize=700%2C423" alt="azure-app-service-plan-3app2instance" srcset="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/10/Azure-App-Service-Plan-3app2instance.png?w=795 795w, https://i2.wp.com/itnerd.space/wp-content/uploads/2016/10/Azure-App-Service-Plan-3app2instance.png?resize=300%2C181 300w, https://i2.wp.com/itnerd.space/wp-content/uploads/2016/10/Azure-App-Service-Plan-3app2instance.png?resize=768%2C464 768w" sizes="(max-width: 700px) 100vw, 700px" data-recalc-dims="1" /></a></p>
<p>Notice how within its sandbox, every App in a same VM will keep seeing it&#8217;s persisted storage as D:\home, and the Temporary storage as D:\local. That&#8217;s quite nice!</p>
<p><strong>Console Access</strong></p>
<p>From Azure Portal you can access the App&#8217;s console: the Kudu tools give access to the Web site app at the sandbox level. From there you can access D:\local and D:\home. The hostname command shows the hostname of the VM (ie. the instance where the console is being connected to).</p>
<p><a href="https://i1.wp.com/itnerd.space/wp-content/uploads/2016/10/asp_console_access.png"><img data-attachment-id="51" data-permalink="http://itnerd.space/2016/10/29/azure-app-service-architecture-2/asp_console_access/" data-orig-file="https://i1.wp.com/itnerd.space/wp-content/uploads/2016/10/asp_console_access.png?fit=1073%2C480" data-orig-size="1073,480" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="asp_console_access" data-image-description="" data-medium-file="https://i1.wp.com/itnerd.space/wp-content/uploads/2016/10/asp_console_access.png?fit=300%2C134" data-large-file="https://i1.wp.com/itnerd.space/wp-content/uploads/2016/10/asp_console_access.png?fit=700%2C313" class="alignnone wp-image-51" src="https://i1.wp.com/itnerd.space/wp-content/uploads/2016/10/asp_console_access.png?resize=700%2C313" alt="asp_console_access" srcset="https://i1.wp.com/itnerd.space/wp-content/uploads/2016/10/asp_console_access.png?w=1073 1073w, https://i1.wp.com/itnerd.space/wp-content/uploads/2016/10/asp_console_access.png?resize=300%2C134 300w, https://i1.wp.com/itnerd.space/wp-content/uploads/2016/10/asp_console_access.png?resize=768%2C344 768w, https://i1.wp.com/itnerd.space/wp-content/uploads/2016/10/asp_console_access.png?resize=1024%2C458 1024w, https://i1.wp.com/itnerd.space/wp-content/uploads/2016/10/asp_console_access.png?resize=670%2C300 670w" sizes="(max-width: 700px) 100vw, 700px" data-recalc-dims="1" /></a></p>
]]></content:encoded>
			<wfw:commentRss>http://itnerd.space/2016/10/29/azure-app-service-architecture-2/feed/</wfw:commentRss>
		<slash:comments>3</slash:comments>
	<post-id xmlns="com-wordpress:feed-additions:1">47</post-id>	</item>
		<item>
		<title>Azure App Service Architecture (1)</title>
		<link>http://itnerd.space/2016/10/28/azure-app-service-architecture-1/</link>
		<comments>http://itnerd.space/2016/10/28/azure-app-service-architecture-1/#respond</comments>
		<pubDate>Fri, 28 Oct 2016 13:16:50 +0000</pubDate>
		<dc:creator><![CDATA[Alex D.]]></dc:creator>
				<category><![CDATA[Cloud]]></category>
		<category><![CDATA[Architecture]]></category>
		<category><![CDATA[Azure]]></category>
		<category><![CDATA[PaaS]]></category>

		<guid isPermaLink="false">http://itnerd.space/?p=38</guid>
		<description><![CDATA[This is the first post of a series on Azure App Service Architecture. This one introduces the concepts of Apps, and Plans, what are the Pricing Tiers and Instance Sizes. The second post will give some more details on how I understand the service plan are architected. The 3rd post looks at how&#8230; ]]></description>
				<content:encoded><![CDATA[<p><em>This is the first post of a series on Azure <a href="http://itnerd.space/?s=Azure+App+Service+Architecture">App Service Architecture</a>. This one introduces the concepts of Apps, and Plans, what are the Pricing Tiers and Instance Sizes. The </em><a href="http://itnerd.space/2016/10/29/azure-app-service-architecture-2/">second post</a><em> will give some more details on how I understand the service plan are architected. The 3rd post looks at how Microsoft implemented <a href="http://itnerd.space/2016/11/02/azure-app-service-architecture-3-app-service-on-linux/">App Service on Linux</a>.</em></p>
<p>Azure App Services is a Platform-as-a-Service (PaaS) cloud service offering by Microsoft focused on providing superior developer productivity without compromising on the need to deliver applications at cloud scale. It also provides the features and frameworks necessary to compose enterprise applications while supporting developers with the most popular development languages (.NET, Java, PHP, Node.JS and Python). With App Service developers can:</p>
<ul>
<li>Build highly scalable Web Apps</li>
<li>Quickly build Mobile App back-ends with a set of easy to use mobile capabilities such as data back-ends, user authentication and push notifications with Mobile Apps.</li>
<li>Implement, deploy and publish APIs with API Apps.</li>
<li>Tie business applications together into workflows and transform data with Logic Apps.</li>
</ul>
<p><img data-attachment-id="43" data-permalink="http://itnerd.space/2016/10/28/azure-app-service-architecture-1/2016-10-28-14_26_33-app-service-documentation-_-azure/" data-orig-file="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/10/2016-10-28-14_26_33-App-Service-Documentation-_-Azure.png?fit=895%2C178" data-orig-size="895,178" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="App Services available on Azure" data-image-description="" data-medium-file="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/10/2016-10-28-14_26_33-App-Service-Documentation-_-Azure.png?fit=300%2C60" data-large-file="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/10/2016-10-28-14_26_33-App-Service-Documentation-_-Azure.png?fit=700%2C139" class="aligncenter wp-image-43 size-full" title="App Services available on Azure" src="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/10/2016-10-28-14_26_33-App-Service-Documentation-_-Azure.png?resize=700%2C139" alt="App Services available on Azure" srcset="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/10/2016-10-28-14_26_33-App-Service-Documentation-_-Azure.png?w=895 895w, https://i2.wp.com/itnerd.space/wp-content/uploads/2016/10/2016-10-28-14_26_33-App-Service-Documentation-_-Azure.png?resize=300%2C60 300w, https://i2.wp.com/itnerd.space/wp-content/uploads/2016/10/2016-10-28-14_26_33-App-Service-Documentation-_-Azure.png?resize=768%2C153 768w" sizes="(max-width: 700px) 100vw, 700px" data-recalc-dims="1" /></p>
<p>To be able to deploy any App on Azure App Service you&#8217;ll need an App Service Plan:</p>
<p><strong>App Service Plans</strong></p>
<p>An App Service Plan represents a set of features and capacity (compute, storage) that you can share across multiple apps. in Azure you deploy a Web App on an App Service Plan, which is formed of one or more (VM) Instance.</p>
<p>App Service Plans are specified by two characteristics:</p>
<ul>
<li>The Pricing Tier: from <em>Free</em>, <em>Shared</em>, <em>Basic</em>, <em>Standard</em> to <em>Premium</em></li>
<li>The Instance Size: from <em>Small</em>, <em>Medium</em>, <em>Large</em> to <em>Extra Large</em></li>
</ul>
<p>The Instance sizes define some compute and storage characteristics of the underlying VM instances that will form the App Service Plan. The CPU and Ram is the same for every Pricing Tier (Basic, Standard or Premium. In Free or Shared you can&#8217;t select the Instance Size). Here are the size available at the time of this writing:</p>
<p><img data-attachment-id="44" data-permalink="http://itnerd.space/2016/10/28/azure-app-service-architecture-1/asp_instancesizes/" data-orig-file="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/10/ASP_InstanceSizes.png?fit=905%2C215" data-orig-size="905,215" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Instance Sizes" data-image-description="" data-medium-file="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/10/ASP_InstanceSizes.png?fit=300%2C71" data-large-file="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/10/ASP_InstanceSizes.png?fit=700%2C166" class="aligncenter wp-image-44" src="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/10/ASP_InstanceSizes.png?resize=497%2C118" alt="Instance Sizes" srcset="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/10/ASP_InstanceSizes.png?w=905 905w, https://i2.wp.com/itnerd.space/wp-content/uploads/2016/10/ASP_InstanceSizes.png?resize=300%2C71 300w, https://i2.wp.com/itnerd.space/wp-content/uploads/2016/10/ASP_InstanceSizes.png?resize=768%2C182 768w" sizes="(max-width: 497px) 100vw, 497px" data-recalc-dims="1" /></p>
<p>The Pricing Tier define some other capacity characteristics as well as features and services that will be available to the App that we deploy in the Plan.</p>
<p><img data-attachment-id="45" data-permalink="http://itnerd.space/2016/10/28/azure-app-service-architecture-1/asp_tiersfeatures/" data-orig-file="https://i0.wp.com/itnerd.space/wp-content/uploads/2016/10/ASP_TiersFeatures.png?fit=709%2C278" data-orig-size="709,278" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="asp_tiersfeatures" data-image-description="" data-medium-file="https://i0.wp.com/itnerd.space/wp-content/uploads/2016/10/ASP_TiersFeatures.png?fit=300%2C118" data-large-file="https://i0.wp.com/itnerd.space/wp-content/uploads/2016/10/ASP_TiersFeatures.png?fit=700%2C274" class="aligncenter wp-image-45 size-full" src="https://i0.wp.com/itnerd.space/wp-content/uploads/2016/10/ASP_TiersFeatures.png?resize=700%2C274" alt="asp_tiersfeatures" srcset="https://i0.wp.com/itnerd.space/wp-content/uploads/2016/10/ASP_TiersFeatures.png?w=709 709w, https://i0.wp.com/itnerd.space/wp-content/uploads/2016/10/ASP_TiersFeatures.png?resize=300%2C118 300w" sizes="(max-width: 700px) 100vw, 700px" data-recalc-dims="1" /></p>
<p>Note that in the <em>Free</em> and <em>Shared</em> tier, the VM Instances are shared in a multitenant fashion (possibly with other customers), while from <em>Basic</em> to <em>Premium </em>tiers, the VM Instances are dedicated.</p>
<p>Internally (in API documentation,&#8230;), App Service Plan are actually called &#8220;hosting Plan&#8221; or &#8220;serverFarm&#8221;, which reveal the true nature of what they really are.</p>
<p><strong>Deployment model</strong></p>
<p>From a deployment perspective, Apps in the same subscription and geographic location can share a plan. All the apps that share a plan can use all the capabilities and features that are defined by the plan&#8217;s tier. All apps that are associated with a plan run on the resources (VM Instances) that the plan defines:</p>
<p><a href="https://i1.wp.com/itnerd.space/wp-content/uploads/2016/10/2016-10-28-14_23_33-Azure_App_Services-Architecture.vsd-Microsoft-Visio.png"><img data-attachment-id="42" data-permalink="http://itnerd.space/2016/10/28/azure-app-service-architecture-1/2016-10-28-14_23_33-azure_app_services-architecture-vsd-microsoft-visio/" data-orig-file="https://i1.wp.com/itnerd.space/wp-content/uploads/2016/10/2016-10-28-14_23_33-Azure_App_Services-Architecture.vsd-Microsoft-Visio.png?fit=415%2C277" data-orig-size="415,277" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Azure App Service Deployment model" data-image-description="" data-medium-file="https://i1.wp.com/itnerd.space/wp-content/uploads/2016/10/2016-10-28-14_23_33-Azure_App_Services-Architecture.vsd-Microsoft-Visio.png?fit=300%2C200" data-large-file="https://i1.wp.com/itnerd.space/wp-content/uploads/2016/10/2016-10-28-14_23_33-Azure_App_Services-Architecture.vsd-Microsoft-Visio.png?fit=415%2C277" class="aligncenter wp-image-42 size-full" src="https://i1.wp.com/itnerd.space/wp-content/uploads/2016/10/2016-10-28-14_23_33-Azure_App_Services-Architecture.vsd-Microsoft-Visio.png?resize=415%2C277" alt="Azure App Service Deployment model" srcset="https://i1.wp.com/itnerd.space/wp-content/uploads/2016/10/2016-10-28-14_23_33-Azure_App_Services-Architecture.vsd-Microsoft-Visio.png?w=415 415w, https://i1.wp.com/itnerd.space/wp-content/uploads/2016/10/2016-10-28-14_23_33-Azure_App_Services-Architecture.vsd-Microsoft-Visio.png?resize=300%2C200 300w" sizes="(max-width: 415px) 100vw, 415px" data-recalc-dims="1" /></a></p>
<p><strong>Scalability Up &amp; Out</strong></p>
<p>Scalability of the App Service Plan is achieve either horizontally by adding more VM Instances to the Plan (Scale-Out), or vertically, by changing to  a larger Instance Size (Scale-Up).</p>
<p>Scaling-Up is a manual action, which occurs without service impact. Scaling-Out can be done manually, scheduled to happen periodically, or automated based on some performance metrics (from the Plan itself, or other resources like the Storage, Service Bus,&#8230;).</p>
<p>I&#8217;ve dedicated a whole post to how Azure achieves Scalability of the App Service Plans.</p>
<p><em>Watch out for my </em><a href="http://itnerd.space/2016/10/29/azure-app-service-architecture-2/">next post</a><em> where I&#8217;ll explain how App Service Plans are architected internally.</em></p>
]]></content:encoded>
			<wfw:commentRss>http://itnerd.space/2016/10/28/azure-app-service-architecture-1/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
	<post-id xmlns="com-wordpress:feed-additions:1">38</post-id>	</item>
		<item>
		<title>Offsite Linux backup to Mega with duplicity</title>
		<link>http://itnerd.space/2016/10/26/offsite-backup-with-duplicity-and-mega/</link>
		<comments>http://itnerd.space/2016/10/26/offsite-backup-with-duplicity-and-mega/#respond</comments>
		<pubDate>Wed, 26 Oct 2016 23:22:10 +0000</pubDate>
		<dc:creator><![CDATA[Alex D.]]></dc:creator>
				<category><![CDATA[Cloud]]></category>
		<category><![CDATA[How-to]]></category>
		<category><![CDATA[Linux]]></category>
		<category><![CDATA[backup]]></category>
		<category><![CDATA[cloud]]></category>
		<category><![CDATA[docker]]></category>
		<category><![CDATA[duplicity]]></category>
		<category><![CDATA[mega]]></category>

		<guid isPermaLink="false">http://itnerd.space/?p=7</guid>
		<description><![CDATA[This is about a small personal initiative: I was looking for a solution to backup some Linux servers that I have, at home and in the cloud. Ideally, my requirements were: Backup should be offsite, preferably in the cloud Solution should support some kind of backup policies (full, incremental, and&#8230; ]]></description>
				<content:encoded><![CDATA[<p>This is about a small personal initiative: I was looking for a solution to backup some Linux servers that I have, at home and in the cloud.</p>
<p>Ideally, my requirements were:</p>
<ul>
<li>Backup should be offsite, preferably in the cloud</li>
<li>Solution should support some kind of backup policies (full, incremental, and retention time)</li>
<li>Solution should be secure, so support encryption</li>
<li>Solution should be portable, so same solution would play nicely with the servers, not mess with their OS (dependencies,&#8230;)</li>
<li>Solution should be as cheap as possible (or ideally free!)</li>
</ul>
<p><span id="more-7"></span></p>
<p>For the offsite storage I first though of using AWS Glacier, a cloud storage meant for cold data that you archive, and don&#8217;t need to retrieve often, but the cost was not so cheap. While storage in itself was not too expensive, the cost of retrieving the data (in case you want to restore, which is the point of having a backup, right?), was kind of prohibitive (for the budget I had in mind). So I started to look for alternatives.</p>
<p>For the backup solution, I wanted to use <a href="http://duplicity.nongnu.org/" target="_blank">duplicity</a>. Duplicity supports full and incremental backups, using the rsync protocol, and have support for a lot of storage backend: file, FTP, SSH, AWS S3, Azure, Dropbox, OneDrive, Mega,&#8230; Most of those backends are either illimited but paid services, or free but rather limited (in capacity) storage. All but Mega, which offer for free 50GB of storage, which is quite nice for backup purpose. Perfect fit in my case.</p>
<p>Regarding the portability requirement, I love Docker containers, and all I deploy now for my personal projects is Dockerized. This wasn&#8217;t going to be an exception. Especially I&#8217;d hate to install all kind of dependencies for duplicity and the storage backend plugins in all my servers!</p>
<p>So Docker it would be.</p>
<p>Now back to the storage layer in our solution: although duplicity supposedly have support for a Mega backend, it seems Mega changed their API/SDK, and the current plugin is not working anymore, and would need to be reworked totally. So as an alternative, I turned to using MegaFuse, a Fuse module to mount Mega storage in Linux: so the idea is we first mount the Mega account as a filesystem in Linux, and then we use it as destination of our backup with duplicity (using the file backend). Not as cool as having duplicity talk directly to Mega, but that seems to work equally.</p>
<p>So to recap, we have a container with duplicity and MegaFuse. As the container is stateless, we&#8217;ll map some volumes from the host to the container so the container gets the needed information:</p>
<ul>
<li>/vol/dupmega/megafuse.conf, containing some config for MegaFuse, like the credentials to the Mega account (see below),</li>
<li>As duplicity and MegaFuse both keep a local cache with some metadata, having those stored in the container would do no good, so I also put that in host mapped folder (/vol/dupmega/cache/duplicity/ and /vol/dupmega/cache/megafuse/)</li>
<li>Of course, we want to backup the host, not the container, so we need to map that as well into the container to /source</li>
</ul>
<p>The megafuse.conf contains:</p>
<p><code>USERNAME = username@domain.com<br />
PASSWORD = aV3ryComplexMegaP4ssw0rd<br />
MOUNTPOINT = /mega<br />
CACHEPATH = /dupmega/cache/megafuse<br />
</code><br />
So the Mega account is mounted in /mega in the container, and the MegaFuse cache will be in /dupmega/cache/megafuse (host mounted volume).</p>
<p>Here is the Dockerfile I have used to create my duplicity container with MegaFuse support. Right now it&#8217;s not yet published to Docker Hub. Right now it&#8217;s very rudimentary, there&#8217;s not even a CMD.</p>
<p><code>FROM ubuntu:14.04<br />
MAINTAINER Alexandre Dumont &lt;adumont@gmail.com&gt;</code></p>
<p>ENV DEBIAN_FRONTEND=noninteractive</p>
<p>RUN sed -i -e &#8216;/^deb-src/ s/^/#/&#8217; /etc/apt/sources.list &amp;&amp; \<br />
echo &#8220;force-unsafe-io&#8221; &gt; /etc/dpkg/dpkg.cfg.d/02apt-speedup &amp;&amp; \<br />
echo &#8220;Acquire::http {No-Cache=True;};&#8221; &gt; /etc/apt/apt.conf.d/no-cache &amp;&amp; \<br />
apt-get update &amp;&amp; \<br />
apt-get -qy dist-upgrade &amp;&amp; \<br />
apt-get install -y libcrypto++-dev libcurl4-openssl-dev libfreeimage-dev libreadline-dev libfuse-dev libdb++-dev duplicity git g++ make &amp;&amp; \<br />
apt-get clean &amp;&amp; \<br />
rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/* &amp;&amp; \<br />
git clone https://github.com/matteoserva/MegaFuse &amp;&amp; \<br />
cd MegaFuse &amp;&amp; \<br />
make</p>
<p>I use the following command to build the image:</p>
<p><code>docker build -t adumont/dupmega --no-cache=true .</code></p>
<p>And here&#8217;s the image:</p>
<p><code>REPOSITORY TAG IMAGE ID CREATED SIZE<br />
adumont/dupmega latest 3bf1d313aa56 7 days ago 581.8 MB<br />
</code></p>
<p>I still have to work on simplifying the whole process of running a backup. For now, I do it rather manually, but it will become a script and be scheduled in cron most likely.</p>
<p>Right now that&#8217;s how I run it, notice the volume mapping from host to containers. Also notice the container has to run as privileged, so it can use Fuse from inside the container. The source to be backed up is mounted read-only (least privilege).</p>
<p><code>host# docker run --rm -h $( hostname ) -ti --privileged \<br />
-v /vol/dupmega:/dupmega \<br />
-v /root/.gnupg:/root/.gnupg \<br />
-v /vol/dupmega/cache/duplicity:/root/.cache/duplicity \<br />
-v /:/source:ro adumont/dupmega<br />
</code></p>
<p>Then from inside the container, I run:</p>
<p><code>mkdir /mega; MegaFuse/MegaFuse -c /dupmega/megafuse.conf &amp;&gt;/dev/null &amp;<br />
sleep 10<br />
[ -d /mega/backups/$(hostname) ] || exit 1</p>
<p>export PASSPHRASE=AnotherVeryComplexPassphaseForGPGEncrypti0n</code></p>
<p>and finally the duplicity command which will backup /source to /mega. The command is different for each server, as I tweak which files/folders I want to include/exclude in the backup:</p>
<p><code>duplicity --asynchronous-upload \<br />
--include=/source/var/lib/docker/containers \<br />
--include=/source/var/lib/plexmediaserver/Library/Application\ Support/Plex\ Media\ Server/Preferences.xml \<br />
--exclude=/source/dev \<br />
--exclude=/source/proc \<br />
--exclude=/source/run \<br />
--exclude=/source/sys \<br />
--exclude=/source/zfs \<br />
--exclude=/source/mnt \<br />
--exclude=/source/media \<br />
--exclude=/source/vol/dupmega/cache \<br />
--exclude=/source/tank \<br />
--exclude=/source/vbox \<br />
--exclude=/source/var/lib/docker \<br />
--exclude=/source/var/lib/plexmediaserver/ \<br />
--exclude=/source/tmp \<br />
--exclude=/source/var/tmp \<br />
--exclude=/source/var/cache \<br />
--exclude=/source/var/log \<br />
/source/ file:///mega/backups/$(hostname)/ -v info<br />
</code></p>
<p>And this would be a sample output:</p>
<p><code>Local and Remote metadata are synchronized, no sync needed.<br />
Last full backup date: Thu Oct 20 22:51:23 2016<br />
Deleting /tmp/duplicity-Cwz5Ju-tempdir/mktemp-0lEM40-2<br />
Using temporary directory /root/.cache/duplicity/185b874acbbae73c5807a4cc767e4967/duplicity-kYzeVT-tempdir<br />
Using temporary directory /root/.cache/duplicity/185b874acbbae73c5807a4cc767e4967/duplicity-jWJXmd-tempdir<br />
AsyncScheduler: instantiating at concurrency 1<br />
M boot/grub/grubenv<br />
A etc<br />
A etc/apparmor.d/cache<br />
M etc/apparmor.d/cache/docker<br />
[...]<br />
---------------[ Backup Statistics ]--------------<br />
StartTime 1477499247.82 (Wed Oct 26 16:27:27 2016)<br />
EndTime 1477499514.97 (Wed Oct 26 16:31:54 2016)<br />
ElapsedTime 267.15 (4 minutes 27.15 seconds)<br />
SourceFiles 449013<br />
SourceFileSize 3239446764 (3.02 GB)<br />
NewFiles 75<br />
NewFileSize 189457 (185 KB)<br />
DeletedFiles 135<br />
ChangedFiles 68<br />
ChangedFileSize 176144101 (168 MB)<br />
ChangedDeltaSize 0 (0 bytes)<br />
DeltaEntries 278<br />
RawDeltaSize 9317325 (8.89 MB)<br />
TotalDestinationSizeChange 1913375 (1.82 MB)<br />
Errors 0<br />
-------------------------------------------------<br />
</code></p>
<p>And backup are really stored on Mega <img src="https://s.w.org/images/core/emoji/2.3/72x72/1f609.png" alt="😉" class="wp-smiley" style="height: 1em; max-height: 1em;" /> :</p>
<p><a href="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/10/Screenshot-from-2016-10-27-01-10-42.png"><img data-attachment-id="13" data-permalink="http://itnerd.space/2016/10/26/offsite-backup-with-duplicity-and-mega/screenshot-from-2016-10-27-01-10-42/" data-orig-file="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/10/Screenshot-from-2016-10-27-01-10-42.png?fit=1304%2C747" data-orig-size="1304,747" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="screenshot-from-2016-10-27-01-10-42" data-image-description="" data-medium-file="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/10/Screenshot-from-2016-10-27-01-10-42.png?fit=300%2C172" data-large-file="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/10/Screenshot-from-2016-10-27-01-10-42.png?fit=700%2C401" class="aligncenter wp-image-13 size-large" src="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/10/Screenshot-from-2016-10-27-01-10-42.png?resize=700%2C401" alt="backup files on Mega" srcset="https://i2.wp.com/itnerd.space/wp-content/uploads/2016/10/Screenshot-from-2016-10-27-01-10-42.png?resize=1024%2C587 1024w, https://i2.wp.com/itnerd.space/wp-content/uploads/2016/10/Screenshot-from-2016-10-27-01-10-42.png?resize=300%2C172 300w, https://i2.wp.com/itnerd.space/wp-content/uploads/2016/10/Screenshot-from-2016-10-27-01-10-42.png?resize=768%2C440 768w, https://i2.wp.com/itnerd.space/wp-content/uploads/2016/10/Screenshot-from-2016-10-27-01-10-42.png?w=1304 1304w" sizes="(max-width: 700px) 100vw, 700px" data-recalc-dims="1" /></a></p>
]]></content:encoded>
			<wfw:commentRss>http://itnerd.space/2016/10/26/offsite-backup-with-duplicity-and-mega/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
	<post-id xmlns="com-wordpress:feed-additions:1">7</post-id>	</item>
	</channel>
</rss>

<!-- Performance optimized by W3 Total Cache. Learn more: https://www.w3-edge.com/products/

Object Caching 4651/4660 objects using disk
Page Caching using disk: enhanced
Database Caching 2/8 queries in 0.059 seconds using disk

 Served from: itnerd.space @ 2017-07-13 21:35:35 by W3 Total Cache -->