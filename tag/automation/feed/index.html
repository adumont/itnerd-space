<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>Automation &#8211; IT Nerd Space</title>
	<atom:link href="http://itnerd.space/tag/automation/feed/" rel="self" type="application/rss+xml" />
	<link>http://itnerd.space</link>
	<description>Blog about Cloud, Automation, Android, Smart things...</description>
	<lastBuildDate>Thu, 27 Jul 2017 21:21:14 +0000</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>hourly</sy:updatePeriod>
	<sy:updateFrequency>1</sy:updateFrequency>
	<generator>https://wordpress.org/?v=4.8</generator>

<image>
	<url>http://itnerd.space/wp-content/uploads/2016/10/cropped-99789e30b0a6eac11f33246750ca29f9-32x32.jpg</url>
	<title>Automation &#8211; IT Nerd Space</title>
	<link>http://itnerd.space</link>
	<width>32</width>
	<height>32</height>
</image> 
	<item>
		<title>How to authenticate to TP Link cloud API with Tasker</title>
		<link>http://itnerd.space/2017/06/19/how-to-authenticate-to-tp-link-cloud-api-with-tasker/</link>
		<comments>http://itnerd.space/2017/06/19/how-to-authenticate-to-tp-link-cloud-api-with-tasker/#respond</comments>
		<pubDate>Mon, 19 Jun 2017 23:03:06 +0000</pubDate>
		<dc:creator><![CDATA[admin]]></dc:creator>
				<category><![CDATA[Automation]]></category>
		<category><![CDATA[How-to]]></category>
		<category><![CDATA[HS100]]></category>
		<category><![CDATA[IoT]]></category>
		<category><![CDATA[Smart Things]]></category>
		<category><![CDATA[Tasker]]></category>

		<guid isPermaLink="false">http://itnerd.space/?p=356</guid>
		<description><![CDATA[We&#8217;ve seen in a previous post what is the protocol to authenticate toÂ TP Link cloud API.Â Now, what about doing that from Tasker you can ask me?Â Well, that&#8217;s very simple actually! To implement that in Tasker I have used RESTask for Tasker (because I had troubles having the native HTTP Post&#8230; ]]></description>
				<content:encoded><![CDATA[<p>We&#8217;ve seen in a previous post what is the <a href="http://itnerd.space/2017/06/19/how-to-authenticate-to-tp-link-cloud-api/" target="_blank" rel="noopener">protocol to authenticate toÂ TP Link cloud API</a>.Â Now, what about doing that from <strong>Tasker</strong> you can ask me?Â Well, that&#8217;s very simple actually!</p>
<p>To implement that in Tasker I have used <em>RESTask for Tasker</em> (because I had troubles having the native HTTP Post action work for me):</p>
<!-- WP-Appbox (Version: 4.0.15 // Store: googleplay // ID: com.freehaha.restask) --><p><a target="_blank" rel="nofollow" href="https://play.google.com/store/apps/details?id=com.freehaha.restask&hl=en" title="RESTask for Tasker">RESTask for Tasker (Free, Google Play) â†’</a></p><!-- /WP-Appbox -->
<p>Next create 3 global variables in Tasker (self-explanatory I guess):</p>
<ul>
<li>TPLUSER</li>
<li>TPLPASS</li>
<li>TPLTERM (use the UUIDv4 you got above)</li>
</ul>
<p>Then create a new Task with the following 4 actions:</p>
<p>The first action will be a Variable Set %payload:</p>
<pre>Name:%payload
To: { "method" :"login",
"params" : {
  "appType" :"Kasa_Android",
  "cloudPassword" :"%TPLPASS",
  "cloudUserName" :"%TPLUSER",
  "terminalUUID" :"%TPLTERM" } }</pre>
<p>The second action will be the RESTask call:</p>
<p><a href="http://itnerd.space/wp-content/uploads/2017/06/Screenshot_20170620-003302-e1497911892955.png"><img data-attachment-id="348" data-permalink="http://itnerd.space/2017/06/19/how-to-authenticate-to-tp-link-cloud-api/screenshot_20170620-003302/" data-orig-file="http://itnerd.space/wp-content/uploads/2017/06/Screenshot_20170620-003302-e1497911892955.png" data-orig-size="1080,780" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Screenshot_20170620-003302" data-image-description="" data-medium-file="http://itnerd.space/wp-content/uploads/2017/06/Screenshot_20170620-003302-e1497911892955-300x217.png" data-large-file="http://itnerd.space/wp-content/uploads/2017/06/Screenshot_20170620-003302-e1497911892955-1024x740.png" class="aligncenter wp-image-348 size-medium" src="http://itnerd.space/wp-content/uploads/2017/06/Screenshot_20170620-003302-e1497911892955-300x217.png" alt="" width="300" height="217" srcset="http://itnerd.space/wp-content/uploads/2017/06/Screenshot_20170620-003302-e1497911892955-300x217.png 300w, http://itnerd.space/wp-content/uploads/2017/06/Screenshot_20170620-003302-e1497911892955-768x555.png 768w, http://itnerd.space/wp-content/uploads/2017/06/Screenshot_20170620-003302-e1497911892955-1024x740.png 1024w, http://itnerd.space/wp-content/uploads/2017/06/Screenshot_20170620-003302-e1497911892955-30x22.png 30w, http://itnerd.space/wp-content/uploads/2017/06/Screenshot_20170620-003302-e1497911892955-474x342.png 474w, http://itnerd.space/wp-content/uploads/2017/06/Screenshot_20170620-003302-e1497911892955.png 1080w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>Further down we need to set the custom body to %payload:</p>
<p><a href="http://itnerd.space/wp-content/uploads/2017/06/wp-1497911865255.-e1497912130632.jpg"><img data-attachment-id="351" data-permalink="http://itnerd.space/2017/06/19/how-to-authenticate-to-tp-link-cloud-api/wp-1497911865255/" data-orig-file="http://itnerd.space/wp-content/uploads/2017/06/wp-1497911865255.-e1497912130632.jpg" data-orig-size="1629,637" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="wp-1497911865255." data-image-description="" data-medium-file="http://itnerd.space/wp-content/uploads/2017/06/wp-1497911865255.-e1497912130632-300x117.jpg" data-large-file="http://itnerd.space/wp-content/uploads/2017/06/wp-1497911865255.-e1497912130632-1024x400.jpg" class="aligncenter wp-image-351 size-medium" src="http://itnerd.space/wp-content/uploads/2017/06/wp-1497911865255.-e1497912130632-300x117.jpg" alt="" width="300" height="117" srcset="http://itnerd.space/wp-content/uploads/2017/06/wp-1497911865255.-e1497912130632-300x117.jpg 300w, http://itnerd.space/wp-content/uploads/2017/06/wp-1497911865255.-e1497912130632-768x300.jpg 768w, http://itnerd.space/wp-content/uploads/2017/06/wp-1497911865255.-e1497912130632-1024x400.jpg 1024w, http://itnerd.space/wp-content/uploads/2017/06/wp-1497911865255.-e1497912130632-30x12.jpg 30w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>Then we set the Headers:<br />
<a href="http://itnerd.space/screenshot_20170620-003330/"></p>
<p></a><a href="http://itnerd.space/wp-content/uploads/2017/06/Screenshot_20170620-003330-e1497911947690.png"><img data-attachment-id="349" data-permalink="http://itnerd.space/2017/06/19/how-to-authenticate-to-tp-link-cloud-api/screenshot_20170620-003330/" data-orig-file="http://itnerd.space/wp-content/uploads/2017/06/Screenshot_20170620-003330-e1497911947690.png" data-orig-size="1080,542" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Screenshot_20170620-003330" data-image-description="" data-medium-file="http://itnerd.space/wp-content/uploads/2017/06/Screenshot_20170620-003330-e1497911947690-300x151.png" data-large-file="http://itnerd.space/wp-content/uploads/2017/06/Screenshot_20170620-003330-e1497911947690-1024x514.png" class="aligncenter wp-image-349 size-medium" src="http://itnerd.space/wp-content/uploads/2017/06/Screenshot_20170620-003330-e1497911947690-300x151.png" alt="" width="300" height="151" srcset="http://itnerd.space/wp-content/uploads/2017/06/Screenshot_20170620-003330-e1497911947690-300x151.png 300w, http://itnerd.space/wp-content/uploads/2017/06/Screenshot_20170620-003330-e1497911947690-768x385.png 768w, http://itnerd.space/wp-content/uploads/2017/06/Screenshot_20170620-003330-e1497911947690-1024x514.png 1024w, http://itnerd.space/wp-content/uploads/2017/06/Screenshot_20170620-003330-e1497911947690-30x15.png 30w, http://itnerd.space/wp-content/uploads/2017/06/Screenshot_20170620-003330-e1497911947690.png 1080w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>The third action will be a Javascriptlet with the following code, to extract the token (from the rtres, passed from Â RESTask) to the %mtoken variable:</p>
<pre>var mtoken = JSON.parse(rtres).result.token;</pre>
<p>Finally, here the fourth action will just be a Flash action, that will show the token:</p>
<pre>Flash [ Text:%mtoken Long:On ]</pre>
<p>The whole task should end up looking like this:</p>
<p><a href="http://itnerd.space/wp-content/uploads/2017/06/wp-1497912544523.-e1497912760328.jpg"><img data-attachment-id="352" data-permalink="http://itnerd.space/2017/06/19/how-to-authenticate-to-tp-link-cloud-api/wp-1497912544523/" data-orig-file="http://itnerd.space/wp-content/uploads/2017/06/wp-1497912544523.-e1497912760328.jpg" data-orig-size="1629,1547" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="wp-1497912544523." data-image-description="" data-medium-file="http://itnerd.space/wp-content/uploads/2017/06/wp-1497912544523.-e1497912760328-300x285.jpg" data-large-file="http://itnerd.space/wp-content/uploads/2017/06/wp-1497912544523.-e1497912760328-1024x972.jpg" class="aligncenter wp-image-352 size-medium" src="http://itnerd.space/wp-content/uploads/2017/06/wp-1497912544523.-e1497912760328-300x285.jpg" alt="" width="300" height="285" srcset="http://itnerd.space/wp-content/uploads/2017/06/wp-1497912544523.-e1497912760328-300x285.jpg 300w, http://itnerd.space/wp-content/uploads/2017/06/wp-1497912544523.-e1497912760328-768x729.jpg 768w, http://itnerd.space/wp-content/uploads/2017/06/wp-1497912544523.-e1497912760328-1024x972.jpg 1024w, http://itnerd.space/wp-content/uploads/2017/06/wp-1497912544523.-e1497912760328-30x28.jpg 30w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>You can run the Task and it should flash the token on the screen!! Yay</p>
]]></content:encoded>
			<wfw:commentRss>http://itnerd.space/2017/06/19/how-to-authenticate-to-tp-link-cloud-api-with-tasker/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>How to authenticate to TP-Link cloud API</title>
		<link>http://itnerd.space/2017/06/19/how-to-authenticate-to-tp-link-cloud-api/</link>
		<comments>http://itnerd.space/2017/06/19/how-to-authenticate-to-tp-link-cloud-api/#comments</comments>
		<pubDate>Mon, 19 Jun 2017 23:01:45 +0000</pubDate>
		<dc:creator><![CDATA[admin]]></dc:creator>
				<category><![CDATA[Automation]]></category>
		<category><![CDATA[How-to]]></category>
		<category><![CDATA[HS100]]></category>
		<category><![CDATA[IoT]]></category>
		<category><![CDATA[Smart Things]]></category>

		<guid isPermaLink="false">http://itnerd.space/?p=345</guid>
		<description><![CDATA[This is breaking news! No need to hack into your phone&#8217;s backups any more to obtain the TP-Link token! First you need to generate an UUID v4. You can open https://www.uuidgenerator.net/version4 and pick the one they give you there (no need to create one every time, one is fine, just&#8230; ]]></description>
				<content:encoded><![CDATA[<p>This is breaking news! No need to hack into your phone&#8217;s backups any more to obtain the TP-Link token!</p>
<p>First you need to generate an UUID v4. You can open <a href="https://www.uuidgenerator.net/version4">https://www.uuidgenerator.net/version4</a> and pick the one they give you there (no need to create one every time, one is fine, just keep it). This will represent your Client Term ID (like the one of your Kasa App).</p>
<p>Now this is how you can authenticate to the TP Link cloud backend and obtain aÂ <span style="color: #339966;"><strong>token</strong></span>:</p>
<p>We have to do a POST request toÂ https://wap.tplinkcloud.com, with the following payload:</p>
<pre>{
 "method": "login",
 "params": {
 "appType": "Kasa_Android",
 "cloudUserName": "XXXXX",
 "cloudPassword": "XXXXX",
 "terminalUUID": "MY_UUID_v4"
 }
}</pre>
<p>In the payload, replaceÂ cloudUserName andÂ cloudPassword with your TP-Link (or Kasa) credentials, and theÂ terminalUUID with the one you got above.</p>
<p>Remember to pass the HeaderÂ Content-Type: application/json as well.</p>
<p>No need to have any extra tool, you can simply try it with <a href="http://Hurl.it">Hurl.it</a>Â from your browser:</p>
<p><a href="http://itnerd.space/2017/06/19/how-to-authenticate-to-tp-link-cloud-api/screenshot-from-2017-06-20-00-21-19/" rel="attachment wp-att-346"><img data-attachment-id="346" data-permalink="http://itnerd.space/2017/06/19/how-to-authenticate-to-tp-link-cloud-api/screenshot-from-2017-06-20-00-21-19/" data-orig-file="http://itnerd.space/wp-content/uploads/2017/06/Screenshot-from-2017-06-20-00-21-19.png" data-orig-size="592,372" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Screenshot from 2017-06-20 00-21-19" data-image-description="" data-medium-file="http://itnerd.space/wp-content/uploads/2017/06/Screenshot-from-2017-06-20-00-21-19-300x189.png" data-large-file="http://itnerd.space/wp-content/uploads/2017/06/Screenshot-from-2017-06-20-00-21-19.png" class="aligncenter wp-image-346 size-full" src="http://itnerd.space/wp-content/uploads/2017/06/Screenshot-from-2017-06-20-00-21-19.png" alt="" width="592" height="372" srcset="http://itnerd.space/wp-content/uploads/2017/06/Screenshot-from-2017-06-20-00-21-19.png 592w, http://itnerd.space/wp-content/uploads/2017/06/Screenshot-from-2017-06-20-00-21-19-300x189.png 300w, http://itnerd.space/wp-content/uploads/2017/06/Screenshot-from-2017-06-20-00-21-19-30x19.png 30w" sizes="(max-width: 592px) 100vw, 592px" /></a></p>
<p>What you&#8217;ll get should look like this:</p>
<pre>{
 "error_code": 0,
 "result": {
 "regTime": "2017-01-06 08:42:35",
 "email": "XXXXX",
 <span style="color: #008000;">"token": "<strong>YOUR_TOKEN_HERE</strong>"</span>
 }
}</pre>
<p>Isn&#8217;t that cool? Of course you can implement that in any language, Shell script with <a href="https://curlbuilder.com/">cURL</a>, Python, Node.js,&#8230; Your token is response.result.token.</p>
<p>In a next post I&#8217;ll show how to <a href="http://itnerd.space/2017/06/19/how-to-authenticate-to-tp-link-cloud-api-with-tasker/">do the same with Tasker</a>! <img src="https://s.w.org/images/core/emoji/2.3/72x72/1f600.png" alt="ðŸ˜€" class="wp-smiley" style="height: 1em; max-height: 1em;" /></p>
<p>From here you can also have a look at this post:Â <a href="http://itnerd.space/2017/05/21/how-to-get-the-tp-link-hs100-cloud-end-point-url/">Get the end point URL and HS100 Device ID.</a></p>
]]></content:encoded>
			<wfw:commentRss>http://itnerd.space/2017/06/19/how-to-authenticate-to-tp-link-cloud-api/feed/</wfw:commentRss>
		<slash:comments>4</slash:comments>
		</item>
		<item>
		<title>Control your TP-Link HS100 smart plug from your Android Watch!</title>
		<link>http://itnerd.space/2017/04/03/control-your-tp-link-hs100-smart-plug-from-your-android-watch/</link>
		<comments>http://itnerd.space/2017/04/03/control-your-tp-link-hs100-smart-plug-from-your-android-watch/#respond</comments>
		<pubDate>Mon, 03 Apr 2017 22:11:01 +0000</pubDate>
		<dc:creator><![CDATA[Alex D.]]></dc:creator>
				<category><![CDATA[Android]]></category>
		<category><![CDATA[Automation]]></category>
		<category><![CDATA[How-to]]></category>
		<category><![CDATA[HS100]]></category>
		<category><![CDATA[IoT]]></category>
		<category><![CDATA[Smart Things]]></category>
		<category><![CDATA[Tasker]]></category>

		<guid isPermaLink="false">http://itnerd.space/?p=254</guid>
		<description><![CDATA[In this post I&#8217;ll show how I control my TP-Link HS100 smart plug right from my LG G Watch R Android smart watch, from anywhere, which is very handy. The first thing we need is the ability to control the HS100 smart plug from Tasker on our Android phone. If&#8230; ]]></description>
				<content:encoded><![CDATA[<p>In this post I&#8217;ll show how I control my TP-Link HS100 smart plug right from my LG G Watch R Android smart watch, from anywhere, which is very handy.<a href="http://itnerd.space/wp-content/uploads/2017/01/HS100_un_V1_1116_large_2.00_20151006093353.jpg"><img data-attachment-id="193" data-permalink="http://itnerd.space/2017/01/22/how-to-control-your-tp-link-hs100-smartplug-from-internet/hs100_un_v1_1116_large_2-00_20151006093353/" data-orig-file="http://itnerd.space/wp-content/uploads/2017/01/HS100_un_V1_1116_large_2.00_20151006093353.jpg" data-orig-size="960,720" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="HS100_un_V1_1116_large_2.00_20151006093353" data-image-description="" data-medium-file="http://itnerd.space/wp-content/uploads/2017/01/HS100_un_V1_1116_large_2.00_20151006093353-300x225.jpg" data-large-file="http://itnerd.space/wp-content/uploads/2017/01/HS100_un_V1_1116_large_2.00_20151006093353.jpg" class="alignright wp-image-193 size-thumbnail" src="http://itnerd.space/wp-content/uploads/2017/01/HS100_un_V1_1116_large_2.00_20151006093353-150x150.jpg" alt="" width="150" height="150" srcset="http://itnerd.space/wp-content/uploads/2017/01/HS100_un_V1_1116_large_2.00_20151006093353-150x150.jpg 150w, http://itnerd.space/wp-content/uploads/2017/01/HS100_un_V1_1116_large_2.00_20151006093353-100x100.jpg 100w" sizes="(max-width: 150px) 100vw, 150px" /></a></p>
<p>The first thing we need is the ability to control the HS100 smart plug from Tasker on our Android phone. If you haven&#8217;t already, be sure to check my <a href="http://itnerd.space/2017/02/26/control-your-tp-link-hs100-smartplug-with-tasker/">preview post</a> where I explain how to create two Tasker Tasks, that will turnÂ our plug On and Off.</p>
<p>For the next step I&#8217;ll use the WearTasker: with this app you can choose some of your Tasker tasks and publish them on your watch. They will show as buttons when you open WearTasker on your wrist, and the corresponding task will run when pressed. Quite simple. TBH WearTasker Â feels like a natural extension of Tasker to Android Wear.</p>
<!-- WP-Appbox (Version: 4.0.15 // Store: googleplay // ID: com.cuberob.weartasker) --><p><a target="_blank" rel="nofollow" href="https://play.google.com/store/apps/details?id=com.cuberob.weartasker&hl=en" title="WearTasker - Tasker for Wear">WearTasker - Tasker for Wear (Free<sup>+</sup>, Google Play) â†’</a></p><!-- /WP-Appbox -->
<p><em>You can buy a Pro in-app purchase if you&#8217;d like, which unlocksÂ some cool features, but what I use here works with the free version.</em></p>
<p>So let&#8217;sÂ <em>publish</em> both our smart plug tasks. Open Wear Tasker on your phone, and create a new shortcut. Choose your &#8220;Power On Plug&#8221; task, and name it however you like. You can also select an icon and a color. Then repeat the same operations with the other task:</p>
<p><a href="http://itnerd.space/wp-content/uploads/2017/04/Screenshot_20170403-203029.png"><img data-attachment-id="291" data-permalink="http://itnerd.space/2017/04/03/control-your-tp-link-hs100-smart-plug-from-your-android-watch/screenshot_20170403-203029/" data-orig-file="http://itnerd.space/wp-content/uploads/2017/04/Screenshot_20170403-203029.png" data-orig-size="1080,1920" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Screenshot_20170403-203029" data-image-description="" data-medium-file="http://itnerd.space/wp-content/uploads/2017/04/Screenshot_20170403-203029-169x300.png" data-large-file="http://itnerd.space/wp-content/uploads/2017/04/Screenshot_20170403-203029-576x1024.png" class="wp-image-291 size-medium alignnone" src="http://itnerd.space/wp-content/uploads/2017/04/Screenshot_20170403-203029-169x300.png" alt="" width="169" height="300" srcset="http://itnerd.space/wp-content/uploads/2017/04/Screenshot_20170403-203029-169x300.png 169w, http://itnerd.space/wp-content/uploads/2017/04/Screenshot_20170403-203029-768x1365.png 768w, http://itnerd.space/wp-content/uploads/2017/04/Screenshot_20170403-203029-576x1024.png 576w, http://itnerd.space/wp-content/uploads/2017/04/Screenshot_20170403-203029-17x30.png 17w, http://itnerd.space/wp-content/uploads/2017/04/Screenshot_20170403-203029.png 1080w" sizes="(max-width: 169px) 100vw, 169px" /></a>Â <a href="http://itnerd.space/wp-content/uploads/2017/04/Screenshot_20170403-203035.png"><img data-attachment-id="290" data-permalink="http://itnerd.space/2017/04/03/control-your-tp-link-hs100-smart-plug-from-your-android-watch/screenshot_20170403-203035/" data-orig-file="http://itnerd.space/wp-content/uploads/2017/04/Screenshot_20170403-203035.png" data-orig-size="1080,1920" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Screenshot_20170403-203035" data-image-description="" data-medium-file="http://itnerd.space/wp-content/uploads/2017/04/Screenshot_20170403-203035-169x300.png" data-large-file="http://itnerd.space/wp-content/uploads/2017/04/Screenshot_20170403-203035-576x1024.png" class="alignnone size-medium wp-image-290" src="http://itnerd.space/wp-content/uploads/2017/04/Screenshot_20170403-203035-169x300.png" alt="" width="169" height="300" srcset="http://itnerd.space/wp-content/uploads/2017/04/Screenshot_20170403-203035-169x300.png 169w, http://itnerd.space/wp-content/uploads/2017/04/Screenshot_20170403-203035-768x1365.png 768w, http://itnerd.space/wp-content/uploads/2017/04/Screenshot_20170403-203035-576x1024.png 576w, http://itnerd.space/wp-content/uploads/2017/04/Screenshot_20170403-203035-17x30.png 17w, http://itnerd.space/wp-content/uploads/2017/04/Screenshot_20170403-203035.png 1080w" sizes="(max-width: 169px) 100vw, 169px" /></a></p>
<p>Back to the app, it should now look like this:</p>
<p><a href="http://itnerd.space/wp-content/uploads/2017/04/Screenshot_20170403-203021-e1491256563770.png"><img data-attachment-id="292" data-permalink="http://itnerd.space/2017/04/03/control-your-tp-link-hs100-smart-plug-from-your-android-watch/screenshot_20170403-203021/" data-orig-file="http://itnerd.space/wp-content/uploads/2017/04/Screenshot_20170403-203021-e1491256563770.png" data-orig-size="1080,700" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Screenshot_20170403-203021" data-image-description="" data-medium-file="http://itnerd.space/wp-content/uploads/2017/04/Screenshot_20170403-203021-e1491256563770-300x194.png" data-large-file="http://itnerd.space/wp-content/uploads/2017/04/Screenshot_20170403-203021-e1491256563770-1024x664.png" class="wp-image-292 size-medium aligncenter" src="http://itnerd.space/wp-content/uploads/2017/04/Screenshot_20170403-203021-e1491256563770-300x194.png" alt="" width="300" height="194" srcset="http://itnerd.space/wp-content/uploads/2017/04/Screenshot_20170403-203021-e1491256563770-300x194.png 300w, http://itnerd.space/wp-content/uploads/2017/04/Screenshot_20170403-203021-e1491256563770-768x498.png 768w, http://itnerd.space/wp-content/uploads/2017/04/Screenshot_20170403-203021-e1491256563770-1024x664.png 1024w, http://itnerd.space/wp-content/uploads/2017/04/Screenshot_20170403-203021-e1491256563770-30x19.png 30w, http://itnerd.space/wp-content/uploads/2017/04/Screenshot_20170403-203021-e1491256563770.png 1080w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>And that&#8217;s how it will look on your watch:</p>
<p><a href="http://itnerd.space/wp-content/uploads/2017/04/aimg_20170402_165806-01.jpg"><img data-attachment-id="293" data-permalink="http://itnerd.space/2017/04/03/control-your-tp-link-hs100-smart-plug-from-your-android-watch/aimg_20170402_165806-01/" data-orig-file="http://itnerd.space/wp-content/uploads/2017/04/aimg_20170402_165806-01.jpg" data-orig-size="780,520" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;2&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;1039348800&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;3.79&quot;,&quot;iso&quot;:&quot;515&quot;,&quot;shutter_speed&quot;:&quot;0.03030303030303&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;1&quot;}" data-image-title="aimg_20170402_165806-01" data-image-description="" data-medium-file="http://itnerd.space/wp-content/uploads/2017/04/aimg_20170402_165806-01-300x200.jpg" data-large-file="http://itnerd.space/wp-content/uploads/2017/04/aimg_20170402_165806-01.jpg" class="aligncenter wp-image-293 size-full" src="http://itnerd.space/wp-content/uploads/2017/04/aimg_20170402_165806-01.jpg" alt="" width="780" height="520" srcset="http://itnerd.space/wp-content/uploads/2017/04/aimg_20170402_165806-01.jpg 780w, http://itnerd.space/wp-content/uploads/2017/04/aimg_20170402_165806-01-300x200.jpg 300w, http://itnerd.space/wp-content/uploads/2017/04/aimg_20170402_165806-01-768x512.jpg 768w, http://itnerd.space/wp-content/uploads/2017/04/aimg_20170402_165806-01-30x20.jpg 30w" sizes="(max-width: 780px) 100vw, 780px" /></a></p>
<p>Now try to press one of the Task and see how your HS100 smart plug responds!</p>
<p>I love WearTasker. I find it extremely usefull to be able to callÂ Tasker tasks fromÂ my watch. Some other tasks I have there are one to power off my home server, one to refresh my Plex library, and one to send a Whatsapp to my wife with my current location and current route ETA.</p>
]]></content:encoded>
			<wfw:commentRss>http://itnerd.space/2017/04/03/control-your-tp-link-hs100-smart-plug-from-your-android-watch/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>Control your TP-Link HS100 smartplug with Tasker</title>
		<link>http://itnerd.space/2017/02/26/control-your-tp-link-hs100-smartplug-with-tasker/</link>
		<comments>http://itnerd.space/2017/02/26/control-your-tp-link-hs100-smartplug-with-tasker/#comments</comments>
		<pubDate>Sun, 26 Feb 2017 13:56:25 +0000</pubDate>
		<dc:creator><![CDATA[admin]]></dc:creator>
				<category><![CDATA[Android]]></category>
		<category><![CDATA[Automation]]></category>
		<category><![CDATA[How-to]]></category>
		<category><![CDATA[HS100]]></category>
		<category><![CDATA[Smart Things]]></category>
		<category><![CDATA[Tasker]]></category>

		<guid isPermaLink="false">http://itnerd.space/?p=252</guid>
		<description><![CDATA[We&#8217;ve seen in a previous post how to switch our TP-Link HS100 smartplug from command line, from anywhere (not only the local network). In this post we&#8217;ll see how to create some Tasker tasksÂ to control our smartplug. From that, we can imagine any useful/crazy profiles triggered from any events, time,&#8230; ]]></description>
				<content:encoded><![CDATA[<p>We&#8217;ve seen in a previous post <a href="http://itnerd.space/2017/01/22/how-to-control-your-tp-link-hs100-smartplug-from-internet/">how to switch our TP-Link HS100 smartplug from command line</a>, from anywhere (not only the local network). In this post we&#8217;ll see how to create some Tasker tasksÂ to control our smartplug. From that, we can imagine any useful/crazy profiles triggered from any events, time, location and switch the plug On/Off, for example &#8220;when I arrive home, switch on the Christmas Tree&#8230;&#8221; <img src="https://s.w.org/images/core/emoji/2.3/72x72/1f642.png" alt="ðŸ™‚" class="wp-smiley" style="height: 1em; max-height: 1em;" /></p>
<p>To quickly recap, thisÂ isÂ the command that can change the plug state (depending on the %state variable, 0: switch off, 1: switch on):</p>
<pre>curl --request POST "https://eu-wap.tplinkcloud.com/?token=<span style="color: #800080;">%token</span> HTTP/1.1" \
  --data '{"method":"passthrough", "params": {"deviceId": "<span style="color: #800080;">%deviceId</span>", "requestData": "{\"system\":{\"set_relay_state\":{\"state\":<span style="color: #339966;"><strong>%state</strong></span>}}}" }}' \
  --header "Content-Type: application/json"</pre>
<h1>Task 1: Switch Plug On <img src="https://s.w.org/images/core/emoji/2.3/72x72/1f4a1.png" alt="ðŸ’¡" class="wp-smiley" style="height: 1em; max-height: 1em;" /></h1>
<h2>Using an HTTP Post action</h2>
<p>In Tasker let&#8217;s create a new Task called &#8220;Switch Plug On <img src="https://s.w.org/images/core/emoji/2.3/72x72/1f4a1.png" alt="ðŸ’¡" class="wp-smiley" style="height: 1em; max-height: 1em;" />&#8221;, then add Â 3 &#8220;Variable Set&#8221; actions, to set the value of %deviceId, %token and %state to the right values for you.</p>
<p>Then we&#8217;ll useÂ an HTTP Post action, that we&#8217;ll configure like this:</p>
<ul>
<li><span style="text-decoration: underline;">Server:Port</span>: https://eu-wap.tplinkcloud.com</li>
<li><span style="text-decoration: underline;">Path</span>: ?token=%token</li>
<li><span style="text-decoration: underline;">Data / File</span>: {&#8220;method&#8221;:&#8221;passthrough&#8221;, &#8220;params&#8221;: {&#8220;deviceId&#8221;: &#8220;%deviceId&#8221;, &#8220;requestData&#8221;: &#8220;{\&#8221;system\&#8221;:{\&#8221;set_relay_state\&#8221;:{\&#8221;state\&#8221;:%state}}}&#8221; }}</li>
<li><span style="text-decoration: underline;">Timeout</span>: 30</li>
<li><span style="text-decoration: underline;">Content Type</span>: application/json</li>
</ul>
<p><strong>Note</strong>: Remember to change the URL above toÂ the one that works for you (check the <a href="/2017/01/22/how-to-control-your-tp-link-hs100-smartplug-from-internet/#CommonIssues">Common Issues</a>Â section at the end of firstÂ post and its comments).</p>
<p>The resulting Tasker Task will look like this:</p>
<p><a href="http://itnerd.space/wp-content/uploads/2017/02/26-de-febrero-de-2017-165802-cet.png.png"><img data-attachment-id="276" data-permalink="http://itnerd.space/?attachment_id=276" data-orig-file="http://itnerd.space/wp-content/uploads/2017/02/26-de-febrero-de-2017-165802-cet.png-e1488126189207.png" data-orig-size="1080,902" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="26-de-febrero-de-2017-165802-cet.png.png" data-image-description="" data-medium-file="http://itnerd.space/wp-content/uploads/2017/02/26-de-febrero-de-2017-165802-cet.png-e1488126189207-300x251.png" data-large-file="http://itnerd.space/wp-content/uploads/2017/02/26-de-febrero-de-2017-165802-cet.png-e1488126189207-1024x855.png" class="wp-image-276 size-medium aligncenter" src="http://itnerd.space/wp-content/uploads/2017/02/26-de-febrero-de-2017-165802-cet.png-e1488126189207-300x251.png" width="300" height="251" srcset="http://itnerd.space/wp-content/uploads/2017/02/26-de-febrero-de-2017-165802-cet.png-e1488126189207-300x251.png 300w, http://itnerd.space/wp-content/uploads/2017/02/26-de-febrero-de-2017-165802-cet.png-e1488126189207-768x641.png 768w, http://itnerd.space/wp-content/uploads/2017/02/26-de-febrero-de-2017-165802-cet.png-e1488126189207-1024x855.png 1024w, http://itnerd.space/wp-content/uploads/2017/02/26-de-febrero-de-2017-165802-cet.png-e1488126189207-30x25.png 30w, http://itnerd.space/wp-content/uploads/2017/02/26-de-febrero-de-2017-165802-cet.png-e1488126189207.png 1080w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>In text form, it looks like this:</p>
<pre>Switch Plug On &#x1f4a1; (143)
 A1: Variable Set [ Name:%deviceId To:<span style="color: #800080;">YOUR_DEVICE_ID_HERE </span>Recurse Variables:Off Do Maths:Off Append:Off ] 
 A2: Variable Set [ Name:%token To:<span style="color: #800080;">YOUR_TOKEN_ID_HERE </span>Recurse Variables:Off Do Maths:Off Append:Off ] 
 A3: Variable Set [ Name:%state To:<strong><span style="color: #339966;">1</span></strong> Recurse Variables:Off Do Maths:Off Append:Off ] 
 A4: HTTP Post [ Server:Port:https://eu-wap.tplinkcloud.com Path:?token=%token Data / File:{"method":"passthrough", "params": {"deviceId": "%deviceId", "requestData": "{\"system\":{\"set_relay_state\":{\"state\":%state}}}" }} Cookies: User Agent: Timeout:30 Content Type:application/json Output File: Trust Any Certificate:Off ]</pre>
<h2>Using a Run Shell action (2nd way)</h2>
<p>If you have curl available from the command line on your Android phone, you can alternatively use a Run Shell action, instead of the HTTP Post action.</p>
<p>In this case,Â the Tasker Task wouldÂ look like this:</p>
<p><a href="http://itnerd.space/wp-content/uploads/2017/02/26-de-febrero-de-2017-142547-cet.png.png" target="_blank" rel="noopener"><img data-attachment-id="263" data-permalink="http://itnerd.space/2017/02/26/control-your-tp-link-hs100-smartplug-with-tasker/26-de-febrero-de-2017-142547-cet-png-png/" data-orig-file="http://itnerd.space/wp-content/uploads/2017/02/26-de-febrero-de-2017-142547-cet.png-e1488126282816.png" data-orig-size="1080,916" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="26-de-febrero-de-2017-142547-cet.png.png" data-image-description="" data-medium-file="http://itnerd.space/wp-content/uploads/2017/02/26-de-febrero-de-2017-142547-cet.png-e1488126282816-300x254.png" data-large-file="http://itnerd.space/wp-content/uploads/2017/02/26-de-febrero-de-2017-142547-cet.png-e1488126282816-1024x869.png" class="aligncenter wp-image-263 size-medium" src="http://itnerd.space/wp-content/uploads/2017/02/26-de-febrero-de-2017-142547-cet.png-e1488126282816-300x254.png" width="300" height="254" srcset="http://itnerd.space/wp-content/uploads/2017/02/26-de-febrero-de-2017-142547-cet.png-e1488126282816-300x254.png 300w, http://itnerd.space/wp-content/uploads/2017/02/26-de-febrero-de-2017-142547-cet.png-e1488126282816-768x651.png 768w, http://itnerd.space/wp-content/uploads/2017/02/26-de-febrero-de-2017-142547-cet.png-e1488126282816-1024x869.png 1024w, http://itnerd.space/wp-content/uploads/2017/02/26-de-febrero-de-2017-142547-cet.png-e1488126282816-30x25.png 30w, http://itnerd.space/wp-content/uploads/2017/02/26-de-febrero-de-2017-142547-cet.png-e1488126282816.png 1080w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>And in text form it would readÂ like this:</p>
<pre>Switch Plug On &#x1f4a1; (143)
 A1: Variable Set [ Name:%deviceId <span style="color: #800080;"><span style="color: #333333;">To:</span>YOUR_DEVICE_ID_HERE</span> Recurse Variables:Off Do Maths:Off Append:Off ] 
 A2: Variable Set [ Name:%token <span style="color: #800080;"><span style="color: #333333;">To:</span>YOUR_TOKEN_ID_HERE</span> Recurse Variables:Off Do Maths:Off Append:Off ] 
 A3: Variable Set [ Name:%state To:<strong><span style="color: #339966;">1</span></strong> Recurse Variables:Off Do Maths:Off Append:Off ] 
 A4: Run Shell [ Command:curl --request POST "https://eu-wap.tplinkcloud.com/?token=%token HTTP/1.1" --data '{"method":"passthrough", "params": {"deviceId": "%deviceId", "requestData": "{\"system\":{\"set_relay_state\":{\"state\":%state}}}" }}' --header "Content-Type: application/json" Timeout (Seconds):0 Use Root:Off Store Output In: Store Errors In: Store Result In: ]</pre>
<h1>Task 2:Â Switch Off Plug</h1>
<p>Once you have the Switch On task working, you can simply clone it in TaskerÂ and change the %state variable to 0, and that will give you the &#8220;Switch Off Plug&#8221; task!</p>
<h1>Profiles ideas</h1>
<p>Do not hesitate to contribute in the comments with any Profile idea you have to play with your TP-Link HS100 smartplug.</p>
<hr />
<p>You can acquire Tasker from the Play Store, personally I believe it&#8217;s really worth the money. You can also download a 7 days free trial from <a href="http://tasker.dinglisch.net/">Tasker official website</a>.</p>
<!-- WP-Appbox (Version: 4.0.15 // Store: googleplay // ID: net.dinglisch.android.taskerm) --><p><a target="_blank" rel="nofollow" href="https://play.google.com/store/apps/details?id=net.dinglisch.android.taskerm&hl=en" title="Tasker">Tasker (â‚¬2.99, Google Play) â†’</a></p><!-- /WP-Appbox -->
<p>In a next post I&#8217;ll show <a href="http://itnerd.space/2017/04/03/control-your-tp-link-hs100-smart-plug-from-your-android-watch/">how youÂ can controlÂ your smart plug from yourÂ Android smartwatch</a>, which is super cool!</p>
]]></content:encoded>
			<wfw:commentRss>http://itnerd.space/2017/02/26/control-your-tp-link-hs100-smartplug-with-tasker/feed/</wfw:commentRss>
		<slash:comments>2</slash:comments>
		</item>
		<item>
		<title>Script to open URLs and take screenshots</title>
		<link>http://itnerd.space/2017/01/03/batch-to-open-urls-and-take-screenshots/</link>
		<comments>http://itnerd.space/2017/01/03/batch-to-open-urls-and-take-screenshots/#comments</comments>
		<pubDate>Tue, 03 Jan 2017 17:46:05 +0000</pubDate>
		<dc:creator><![CDATA[admin]]></dc:creator>
				<category><![CDATA[Automation]]></category>
		<category><![CDATA[How-to]]></category>
		<category><![CDATA[Azure]]></category>
		<category><![CDATA[Powershell]]></category>
		<category><![CDATA[WebApp]]></category>

		<guid isPermaLink="false">http://itnerd.space/?p=167</guid>
		<description><![CDATA[Say you need to open a lot of URLs to see what they look like. Not in the mood for any more manual work, you prefer to automate the task? Let see how we can read a bunch of URL from an Excel file, load them in MSIE and take a screenshot of each of them. You'll have more time to analyse the results.]]></description>
				<content:encoded><![CDATA[<p>Today I wantedÂ to <em>visually</em> check a lot of URLs, to see if the page was loading fine, or if it was giving any kind of error. So I hadÂ an Excel file with the name of someÂ applications (Azure WebApps), and for each the list URLs of that site, and I needed to load each URL and see, in a browser, what the pages look like.</p>
<p>The good thing is that depending the result, I could easily identify it if I had a high level view of all the pages. That&#8217;s were the thumbnail view comes in!</p>
<p>To do that I needed to automate several individual steps that I would later combine.</p>
<ul>
<li>Get the list of Application names and URLs from an Excel spreadsheet. That part was easy, as I&#8217;m already a fond user ofÂ <a href="https://github.com/dfinke/ImportExcel">ImportExcel PowerShell module</a></li>
<li>Open a URL into a Browser. This <a href="http://stackoverflow.com/a/23347472/728281">StackOverflow answer</a> helped me.</li>
<li>Take a screenshot, ideally of a specific portion of the screen. For that last part I found <a href="http://stackoverflow.com/a/2970339/728281" target="_blank">this other scriplet</a> on SO.</li>
</ul>
<p>So I created a <em>Frankenstein</em> Powershell script combining all the pieces together, which you can see <a href="https://gist.github.com/adumont/bbdfbd0f63be8719b1af87d862a45c56">here</a>.</p>
<p>The input I&#8217;m using is an Excel file, of which I&#8217;ll use two columns: Name and Hostnames, which contains a list of comma-separated URLs, of which I&#8217;ll only take the first one. I&#8217;ll use the Name column to name the output screenshot file.</p>
<p>This is how the Excel file would look like:</p>
<p><a href="http://itnerd.space/wp-content/uploads/2017/01/2017-01-04-11_14_08-Book4-Excel.png"><img data-attachment-id="179" data-permalink="http://itnerd.space/2017/01/03/batch-to-open-urls-and-take-screenshots/2017-01-04-11_14_08-book4-excel/" data-orig-file="http://itnerd.space/wp-content/uploads/2017/01/2017-01-04-11_14_08-Book4-Excel.png" data-orig-size="332,152" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="2017-01-04 11_14_08-Book4 &#8211; Excel" data-image-description="" data-medium-file="http://itnerd.space/wp-content/uploads/2017/01/2017-01-04-11_14_08-Book4-Excel-300x137.png" data-large-file="http://itnerd.space/wp-content/uploads/2017/01/2017-01-04-11_14_08-Book4-Excel.png" class="size-full wp-image-179 aligncenter" src="http://itnerd.space/wp-content/uploads/2017/01/2017-01-04-11_14_08-Book4-Excel.png" alt="" width="332" height="152" srcset="http://itnerd.space/wp-content/uploads/2017/01/2017-01-04-11_14_08-Book4-Excel.png 332w, http://itnerd.space/wp-content/uploads/2017/01/2017-01-04-11_14_08-Book4-Excel-300x137.png 300w, http://itnerd.space/wp-content/uploads/2017/01/2017-01-04-11_14_08-Book4-Excel-30x14.png 30w" sizes="(max-width: 332px) 100vw, 332px" /></a></p>
<p>We load it using Import-Excel CmdLet. In the example case above, we would get:</p>
<pre>PS C:\&gt; Import-Excel D:\temp\file.xlsx

Name HostNames
---- ---------
google google.com, www.google.com
microsoft www.microsoft.com
yahoo yahoo.com</pre>
<p>I didn&#8217;t find a way to take a screenshot of a non visible window, so I am showing the browser, and taking the screenshot of the region. For my purpose it works and it&#8217;s quite simple, but that presents some disadvantages (you cannot use the region of the screen while running the script, or you risk altering the result in the screenshot).</p>
<p>Another disadvantage is that it involves some precaution and some manual preparation, to position the windows, and modify the script accordingly, the first time at least.</p>
<ul>
<li>Open a Powershell command line window</li>
<li>Run the following command. This will open an Internet Explorer window. Place it on your desktop, so that it will not overlap with the Powershell window. They can be side by side. It will be easier if you have two monitors, as you can place the browser window alone on a monitor.</li>
</ul>
<pre> $IE=new-object -com internetexplorer.application
 $IE.visible=$true</pre>
<ul>
<li>Run the following commands and take note of the results:</li>
</ul>
<pre> $IE.Top
 $IE.Left
 $IE.Width
 $IE.Height</pre>
<ul>
<li>Replace the results in the script. That way, each time we open a new browser the script will reposition it in the same location on your screen!</li>
</ul>
<p>That&#8217;s it. Now you just have to run the script and it will do the job.</p>
<p>In the case of our example input file above, the output we&#8217;d get would look like in the output folder places in Thumbnail View:</p>
<p><a href="http://itnerd.space/wp-content/uploads/2017/01/2017-01-04-11_53_35-New-folder.png"><img data-attachment-id="181" data-permalink="http://itnerd.space/2017/01/03/batch-to-open-urls-and-take-screenshots/2017-01-04-11_53_35-new-folder/" data-orig-file="http://itnerd.space/wp-content/uploads/2017/01/2017-01-04-11_53_35-New-folder.png" data-orig-size="572,435" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="2017-01-04 11_53_35-New folder" data-image-description="" data-medium-file="http://itnerd.space/wp-content/uploads/2017/01/2017-01-04-11_53_35-New-folder-300x228.png" data-large-file="http://itnerd.space/wp-content/uploads/2017/01/2017-01-04-11_53_35-New-folder.png" class="size-full wp-image-181 aligncenter" src="http://itnerd.space/wp-content/uploads/2017/01/2017-01-04-11_53_35-New-folder.png" alt="" width="572" height="435" srcset="http://itnerd.space/wp-content/uploads/2017/01/2017-01-04-11_53_35-New-folder.png 572w, http://itnerd.space/wp-content/uploads/2017/01/2017-01-04-11_53_35-New-folder-300x228.png 300w, http://itnerd.space/wp-content/uploads/2017/01/2017-01-04-11_53_35-New-folder-30x23.png 30w" sizes="(max-width: 572px) 100vw, 572px" /></a></p>
<p>In my particular use case, this below is what I was looking for:</p>
<p><a href="http://itnerd.space/wp-content/uploads/2017/01/2017-01-03-18_25_38-Clipboard.png"><img data-attachment-id="174" data-permalink="http://itnerd.space/2017/01/03/batch-to-open-urls-and-take-screenshots/2017-01-03-18_25_38-clipboard/" data-orig-file="http://itnerd.space/wp-content/uploads/2017/01/2017-01-03-18_25_38-Clipboard.png" data-orig-size="1334,671" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="2017-01-03 18_25_38-Clipboard" data-image-description="" data-medium-file="http://itnerd.space/wp-content/uploads/2017/01/2017-01-03-18_25_38-Clipboard-300x151.png" data-large-file="http://itnerd.space/wp-content/uploads/2017/01/2017-01-03-18_25_38-Clipboard-1024x515.png" class="size-full wp-image-174 aligncenter" src="http://itnerd.space/wp-content/uploads/2017/01/2017-01-03-18_25_38-Clipboard.png" alt="" width="1334" height="671" srcset="http://itnerd.space/wp-content/uploads/2017/01/2017-01-03-18_25_38-Clipboard.png 1334w, http://itnerd.space/wp-content/uploads/2017/01/2017-01-03-18_25_38-Clipboard-300x151.png 300w, http://itnerd.space/wp-content/uploads/2017/01/2017-01-03-18_25_38-Clipboard-768x386.png 768w, http://itnerd.space/wp-content/uploads/2017/01/2017-01-03-18_25_38-Clipboard-1024x515.png 1024w, http://itnerd.space/wp-content/uploads/2017/01/2017-01-03-18_25_38-Clipboard-30x15.png 30w" sizes="(max-width: 1334px) 100vw, 1334px" /></a></p>
<p>As you can see, by placing the images in Thumbnail View, we can rapidly identify and classify the corresponding Web sites into 4 groups:</p>
<ol>
<li>Page seems to load fine</li>
<li>Default initial Azure page (possibly no content deployed)</li>
<li>Page doesn&#8217;t load, or takes too long</li>
<li>Some HTTP error</li>
</ol>
<p>Furthermore, within the first category, a quick inspection of the image will show if the page loads apparently fine, or if it shows some content problem.</p>
<p>If you have hundreds of sites, it can save you some precious time!</p>
<p>Some considerations:</p>
<ul>
<li>I&#8217;m not sure what happens if the screen switch to screensaver mode. It may not work as expected. So, either deactivate the screensaver, or keep moving the mouse (out of the browser&#8217;s way) while the script runs.</li>
<li>I use a new IE instance for each new URL, that is, I don&#8217;t recycle the IE instance for several URLs, for a simple reason: if the URL doesn&#8217;t load, I would possibly take a screenshot of the previously loaded URL, which is not what I want.</li>
</ul>
]]></content:encoded>
			<wfw:commentRss>http://itnerd.space/2017/01/03/batch-to-open-urls-and-take-screenshots/feed/</wfw:commentRss>
		<slash:comments>2</slash:comments>
		</item>
		<item>
		<title>How to run Android Java code from Tasker</title>
		<link>http://itnerd.space/2017/01/01/how-to-run-android-java-code-from-tasker/</link>
		<comments>http://itnerd.space/2017/01/01/how-to-run-android-java-code-from-tasker/#respond</comments>
		<pubDate>Sun, 01 Jan 2017 23:13:26 +0000</pubDate>
		<dc:creator><![CDATA[admin]]></dc:creator>
				<category><![CDATA[Android]]></category>
		<category><![CDATA[Automation]]></category>
		<category><![CDATA[How-to]]></category>
		<category><![CDATA[Tasker]]></category>

		<guid isPermaLink="false">http://itnerd.space/?p=156</guid>
		<description><![CDATA[When it comes to Automation in Android, there is no doubt thatÂ TaskerÂ is theÂ absolute king. Although I admit the UI is not fancy &#8212; at all, Â and the learning curve is quite harsh, Tasker has demonstrated being the most powerful app in the Automation space. One of the little know features&#8230; ]]></description>
				<content:encoded><![CDATA[<p>When it comes to Automation in Android, there is no doubt thatÂ <a href="https://play.google.com/store/apps/details?id=net.dinglisch.android.taskerm">Tasker</a>Â is theÂ absolute king. Although I admit the UI is not fancy &#8212; at all, Â and the learning curve is quite harsh, Tasker has demonstrated being the most powerful app in the Automation space.</p>
<!-- WP-Appbox (Version: 4.0.15 // Store: googleplay // ID: net.dinglisch.android.taskerm) --><p><a target="_blank" rel="nofollow" href="https://play.google.com/store/apps/details?id=net.dinglisch.android.taskerm&hl=en" title="Tasker">Tasker (â‚¬2.99, Google Play) â†’</a></p><!-- /WP-Appbox -->
<p>One of the little know features of Tasker is the ability to run <em>Android Java</em> code, sort of.</p>
<p>That requires some learning, as everything in Tasker, but can prove very useful to further extend Tasker possibilities.</p>
<p>Let see a simple example, to illustrate the concept. Let say we want to enable Bluetooth. The corresponding Android Java code would be something like :</p>
<p><img data-attachment-id="148" data-permalink="http://itnerd.space/screenshot_20170101-174128-png/" data-orig-file="http://itnerd.space/wp-content/uploads/2017/01/screenshot_20170101-174128.png" data-orig-size="1920,1080" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="screenshot_20170101-174128.png" data-image-description="" data-medium-file="http://itnerd.space/wp-content/uploads/2017/01/screenshot_20170101-174128-300x169.png" data-large-file="http://itnerd.space/wp-content/uploads/2017/01/screenshot_20170101-174128-1024x576.png" class="alignnone wp-image-148 size-large" src="http://itnerd.space/wp-content/uploads/2017/01/screenshot_20170101-174128-1024x576.png" width="700" height="394" srcset="http://itnerd.space/wp-content/uploads/2017/01/screenshot_20170101-174128-1024x576.png 1024w, http://itnerd.space/wp-content/uploads/2017/01/screenshot_20170101-174128-300x169.png 300w, http://itnerd.space/wp-content/uploads/2017/01/screenshot_20170101-174128-768x432.png 768w, http://itnerd.space/wp-content/uploads/2017/01/screenshot_20170101-174128-30x17.png 30w" sizes="(max-width: 700px) 100vw, 700px" /></p>
<p>In Tasker we would use a couple of <em>Java Function</em> actions that we put in a <em>Tasker task</em> :</p>
<p>First:</p>
<pre style="padding-left: 30px;">BluetoothAdapter bta = BluetoothAdapter.getDefaultAdapter();</pre>
<p><a href="http://itnerd.space/wp-content/uploads/2017/01/screenshot_20170101-175233.png"><img data-attachment-id="149" data-permalink="http://itnerd.space/screenshot_20170101-175233-png/" data-orig-file="http://itnerd.space/wp-content/uploads/2017/01/screenshot_20170101-175233.png" data-orig-size="1080,1920" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="screenshot_20170101-175233.png" data-image-description="" data-medium-file="http://itnerd.space/wp-content/uploads/2017/01/screenshot_20170101-175233-169x300.png" data-large-file="http://itnerd.space/wp-content/uploads/2017/01/screenshot_20170101-175233-576x1024.png" class="aligncenter wp-image-149" src="http://itnerd.space/wp-content/uploads/2017/01/screenshot_20170101-175233-576x1024.png" width="320" height="569" srcset="http://itnerd.space/wp-content/uploads/2017/01/screenshot_20170101-175233-576x1024.png 576w, http://itnerd.space/wp-content/uploads/2017/01/screenshot_20170101-175233-169x300.png 169w, http://itnerd.space/wp-content/uploads/2017/01/screenshot_20170101-175233-768x1365.png 768w, http://itnerd.space/wp-content/uploads/2017/01/screenshot_20170101-175233-17x30.png 17w, http://itnerd.space/wp-content/uploads/2017/01/screenshot_20170101-175233.png 1080w" sizes="(max-width: 320px) 100vw, 320px" /></a></p>
<p>Then:</p>
<pre style="padding-left: 30px;">bta.enable();</pre>
<p><a href="http://itnerd.space/wp-content/uploads/2017/01/screenshot_20170101-175241-2.png"><img data-attachment-id="154" data-permalink="http://itnerd.space/2017/01/01/how-to-run-android-java-code-from-tasker/screenshot_20170101-175241-png-3/" data-orig-file="http://itnerd.space/wp-content/uploads/2017/01/screenshot_20170101-175241-2.png" data-orig-size="1080,1920" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="screenshot_20170101-175241.png" data-image-description="" data-medium-file="http://itnerd.space/wp-content/uploads/2017/01/screenshot_20170101-175241-2-169x300.png" data-large-file="http://itnerd.space/wp-content/uploads/2017/01/screenshot_20170101-175241-2-576x1024.png" class="aligncenter wp-image-154 " src="http://itnerd.space/wp-content/uploads/2017/01/screenshot_20170101-175241-2-576x1024.png" width="320" height="569" srcset="http://itnerd.space/wp-content/uploads/2017/01/screenshot_20170101-175241-2-576x1024.png 576w, http://itnerd.space/wp-content/uploads/2017/01/screenshot_20170101-175241-2-169x300.png 169w, http://itnerd.space/wp-content/uploads/2017/01/screenshot_20170101-175241-2-768x1365.png 768w, http://itnerd.space/wp-content/uploads/2017/01/screenshot_20170101-175241-2-17x30.png 17w, http://itnerd.space/wp-content/uploads/2017/01/screenshot_20170101-175241-2.png 1080w" sizes="(max-width: 320px) 100vw, 320px" /></a></p>
<p>This is the resulting Tasker task:</p>
<pre>Bluetooth Enable (71)
 A1: Java Function [ Return:bta Class Or Object:BluetoothAdapter Function:getDefaultAdapter
{BluetoothAdapter} () Param: Param: Param: Param: Param: Param: Param: ] 
 A2: Java Function [ Return: Class Or Object:bta Function:enable
{boolean} () Param: Param: Param: Param: Param: Param: Param: ]</pre>
<p>This is very powerful and can unleash some new possibilities.</p>
<p>Say you want to enable LinkedIn synchronization on WiFi only. Tasker has no native actions to handle Android accounts synchronization. You need to access the ContentResolver Java objects and methods. This is something Â you can do with Tasker! I&#8217;ll detail this example in a future post.</p>
]]></content:encoded>
			<wfw:commentRss>http://itnerd.space/2017/01/01/how-to-run-android-java-code-from-tasker/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
	</channel>
</rss>
